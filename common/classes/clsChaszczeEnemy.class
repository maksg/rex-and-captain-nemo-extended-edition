OBJECT=S1
S1:TYPE=STRING

OBJECT=SNAME
SNAME:TYPE=STRING

OBJECT=IANNNO
IANNNO:TYPE=INTEGER
IANNNO:VALUE=0

OBJECT=IPOSX
IPOSX:TYPE=INTEGER

OBJECT=IPOSY
IPOSY:TYPE=INTEGER

OBJECT=ISTARTTIME
ISTARTTIME:TYPE=INTEGER
ISTARTTIME:VALUE=0

OBJECT=SFIELDFROM
SFIELDFROM:TYPE=STRING

OBJECT=SFIELDDEAD
SFIELDDEAD:TYPE=STRING
SFIELDDEAD:VALUE=NULL

OBJECT=SFIELD
SFIELD:TYPE=STRING
SFIELD:ONBRUTALCHANGED^TRAWA={SEVENT^SET(SDIRSEL);SDIRSEL^SET(NULL);}
SFIELD:ONBRUTALCHANGED^SLADY={SEVENT^SET(SDIRSEL);SDIRSEL^SET(NULL);}
SFIELD:ONBRUTALCHANGED^SLADY_END={SEVENT^SET(SDIRSEL);SDIRSEL^SET(NULL);}
SFIELD:ONBRUTALCHANGED^ZEJSCIE_DO_WODY={SEVENT^SET(SDIRSEL);SDIRSEL^SET(NULL);}
SFIELD:ONBRUTALCHANGED^POLE_X={SEVENT^SET(SDIRSEL);SDIRSEL^SET(NULL);}
SFIELD:ONBRUTALCHANGED^POLE_Y={SEVENT^SET(SDIRSEL);SDIRSEL^SET(NULL);}
SFIELD:ONBRUTALCHANGED^POLE_LODKA={SEVENT^SET(SDIRSEL);SDIRSEL^SET(NULL);}
SFIELD:ONBRUTALCHANGED^POLE_KEBABY={SEVENT^SET(SDIRSEL);SDIRSEL^SET(NULL);}
SFIELD:ONBRUTALCHANGED^POSADZKA={SEVENT^SET(SDIRSEL);SDIRSEL^SET(NULL);}
SFIELD:ONBRUTALCHANGED^BRUK={SEVENT^SET(SDIRSEL);SDIRSEL^SET(NULL);}
SFIELD:ONBRUTALCHANGED^POSADZKA_POPEKANA={SEVENT^SET(SDIRSEL);SDIRSEL^SET(NULL);}
SFIELD:ONBRUTALCHANGED^MIECZ={SEVENT^SET(SDIRSEL);SDIRSEL^SET(NULL);}
SFIELD:ONBRUTALCHANGED^OSTRZALKA_MALA={SEVENT^SET(SDIRSEL);SDIRSEL^SET(NULL);}
SFIELD:ONBRUTALCHANGED^OSTRZALKA_DUZA={SEVENT^SET(SDIRSEL);SDIRSEL^SET(NULL);}
SFIELD:ONBRUTALCHANGED^OSTRZALKA_KAMIEN={SEVENT^SET(SDIRSEL);SDIRSEL^SET(NULL);}
SFIELD:ONBRUTALCHANGED^KLUCZ_RED={SEVENT^SET(SDIRSEL);SDIRSEL^SET(NULL);}
SFIELD:ONBRUTALCHANGED^KLUCZ_YELLOW={SEVENT^SET(SDIRSEL);SDIRSEL^SET(NULL);}
SFIELD:ONBRUTALCHANGED^EXIT={SEVENT^SET(SDIRSEL);SDIRSEL^SET(NULL);}
SFIELD:ONBRUTALCHANGED^DRZWI_RED_POZ_OPEN={SEVENT^SET(SDIRSEL);SDIRSEL^SET(NULL);}
SFIELD:ONBRUTALCHANGED^DRZWI_RED_PION_OPEN={SEVENT^SET(SDIRSEL);SDIRSEL^SET(NULL);}
SFIELD:ONBRUTALCHANGED^DRZWI_YELLOW_POZ_OPEN={SEVENT^SET(SDIRSEL);SDIRSEL^SET(NULL);}
SFIELD:ONBRUTALCHANGED^DRZWI_YELLOW_PION_OPEN={SEVENT^SET(SDIRSEL);SDIRSEL^SET(NULL);}
SFIELD:ONBRUTALCHANGED^TRAWA_U={SEVENT^SET(SDIRSEL);SDIRSEL^SET(NULL);}
SFIELD:ONBRUTALCHANGED^TRAWA_D={SEVENT^SET(SDIRSEL);SDIRSEL^SET(NULL);}
SFIELD:ONBRUTALCHANGED^TRAWA_L={SEVENT^SET(SDIRSEL);SDIRSEL^SET(NULL);}
SFIELD:ONBRUTALCHANGED^TRAWA_R={SEVENT^SET(SDIRSEL);SDIRSEL^SET(NULL);}
SFIELD:ONBRUTALCHANGED^WODA={SEVENT^SET(SDIRSEL);SDIRSEL^SET(NULL);}
SFIELD:ONBRUTALCHANGED^PLAYER={SFIELDDEAD^SET(ARRMAPABKG^GET([[IPOSY*ISIZEX]+IPOSX]));DEAD^RUN();BEHPLAYERDEATH^RUN();}

OBJECT=SFIELDIDLE
SFIELDIDLE:TYPE=STRING
SFIELDIDLE:ONBRUTALCHANGED^PLAYER={S1^SET(S1);}
SFIELDIDLE:ONBRUTALCHANGED={SDIRSEL^SET(SDIRSELIDLE);}

OBJECT=SDIRSEL
SDIRSEL:TYPE=STRING
SDIRSEL:ONBRUTALCHANGED^U={SFIELD^SET(ARRMAPA^GET(IPOSX,[IPOSY-1]));}
SDIRSEL:ONBRUTALCHANGED^D={SFIELD^SET(ARRMAPA^GET(IPOSX,[IPOSY+1]));}
SDIRSEL:ONBRUTALCHANGED^L={SFIELD^SET(ARRMAPA^GET([IPOSX-1],IPOSY));}
SDIRSEL:ONBRUTALCHANGED^R={SFIELD^SET(ARRMAPA^GET([IPOSX+1],IPOSY));}

OBJECT=SDIRSELIDLE
SDIRSELIDLE:TYPE=STRING
SDIRSELIDLE:ONBRUTALCHANGED^U={SFIELDIDLE^SET(ARRMAPA^GET(IPOSX,[IPOSY-1]));}
SDIRSELIDLE:ONBRUTALCHANGED^D={SFIELDIDLE^SET(ARRMAPA^GET(IPOSX,[IPOSY+1]));}
SDIRSELIDLE:ONBRUTALCHANGED^L={SFIELDIDLE^SET(ARRMAPA^GET([IPOSX-1],IPOSY));}
SDIRSELIDLE:ONBRUTALCHANGED^R={SFIELDIDLE^SET(ARRMAPA^GET([IPOSX+1],IPOSY));}

OBJECT=SEVENT
SEVENT:TYPE=STRING
SEVENT:ONBRUTALCHANGED^U={IPOSY^DEC();ARRMAPA^SET(IPOSX,IPOSY,SNAME);ANNENEMY^PLAY(SEVENT);}
SEVENT:ONBRUTALCHANGED^D={IPOSY^INC();ARRMAPA^SET(IPOSX,IPOSY,SNAME);ANNENEMY^PLAY(SEVENT);}
SEVENT:ONBRUTALCHANGED^L={IPOSX^DEC();ARRMAPA^SET(IPOSX,IPOSY,SNAME);ANNENEMY^PLAY(SEVENT);}
SEVENT:ONBRUTALCHANGED^R={IPOSX^INC();ARRMAPA^SET(IPOSX,IPOSY,SNAME);ANNENEMY^PLAY(SEVENT);}

OBJECT=SEVENTDEAD
SEVENTDEAD:TYPE=STRING
SEVENTDEAD:ONCHANGED^U={ARRMAPA^SET(IPOSX,IPOSY,"DEAD_ENEMY");ARRMAPA^SET(IPOSX,[IPOSY+1],"DEAD_ENEMY");}
SEVENTDEAD:ONCHANGED^D={ARRMAPA^SET(IPOSX,IPOSY,"DEAD_ENEMY");ARRMAPA^SET(IPOSX,[IPOSY-1],"DEAD_ENEMY");}
SEVENTDEAD:ONCHANGED^L={ARRMAPA^SET(IPOSX,IPOSY,"DEAD_ENEMY");ARRMAPA^SET([IPOSX+1],IPOSY,"DEAD_ENEMY");}
SEVENTDEAD:ONCHANGED^R={ARRMAPA^SET(IPOSX,IPOSY,"DEAD_ENEMY");ARRMAPA^SET([IPOSX-1],IPOSY,"DEAD_ENEMY");}
SEVENTDEAD:ONCHANGED^IDLE={ARRMAPA^SET(IPOSX,IPOSY,"DEAD_ENEMY");}

OBJECT=ANNENEMY
ANNENEMY:TYPE=ANIMO
ANNENEMY:VISIBLE=TRUE
ANNENEMY:FILENAME=ENEMY0.ANN
ANNENEMY:TOCANVAS=TRUE
ANNENEMY:PRIORITY=100
ANNENEMY:FPS=40
ANNENEMY:PRELOAD=TRUE
ANNENEMY:RELEASE=TRUE
ANNENEMY:MONITORCOLLISION=FALSE
ANNENEMY:MONITORCOLLISIONALPHA=FALSE
ANNENEMY:ONFRAMECHANGED^U={ANNENEMY^MOVE(0,-2);}
ANNENEMY:ONFRAMECHANGED^D={ANNENEMY^MOVE(0,2);}
ANNENEMY:ONFRAMECHANGED^L={ANNENEMY^MOVE(-2,0);}
ANNENEMY:ONFRAMECHANGED^R={ANNENEMY^MOVE(2,0);}
ANNENEMY:ONFINISHED^U={ARRMAPA^SET(IPOSX,[IPOSY+1],SFIELDFROM);SFIELDFROM^SET(SFIELD);SDIRSEL^SET("L");@IF("SDIRSEL","!_","NULL","BFITMP195","");@IF("SDIRSEL","!_","NULL","BFITMP196","");@IF("SDIRSEL","!_","NULL","BFITMP197","");}
ANNENEMY:ONFINISHED^D={ARRMAPA^SET(IPOSX,[IPOSY-1],SFIELDFROM);SFIELDFROM^SET(SFIELD);SDIRSEL^SET("R");@IF("SDIRSEL","!_","NULL","BFITMP198","");@IF("SDIRSEL","!_","NULL","BFITMP199","");@IF("SDIRSEL","!_","NULL","BFITMP200","");}
ANNENEMY:ONFINISHED^L={ARRMAPA^SET([IPOSX+1],IPOSY,SFIELDFROM);SFIELDFROM^SET(SFIELD);SDIRSEL^SET("D");@IF("SDIRSEL","!_","NULL","BFITMP201","");@IF("SDIRSEL","!_","NULL","BFITMP202","");@IF("SDIRSEL","!_","NULL","BFITMP203","");}
ANNENEMY:ONFINISHED^R={ARRMAPA^SET([IPOSX-1],IPOSY,SFIELDFROM);SFIELDFROM^SET(SFIELD);SDIRSEL^SET("U");@IF("SDIRSEL","!_","NULL","BFITMP204","");@IF("SDIRSEL","!_","NULL","BFITMP205","");@IF("SDIRSEL","!_","NULL","BFITMP206","");}
ANNENEMY:ONFINISHED^IDLE={@IF("ISTARTTIME","_","0","BFITMP211","BFITMP212");}

OBJECT=CONSTRUCTOR
CONSTRUCTOR:TYPE=BEHAVIOUR
CONSTRUCTOR:CODE={SNAME^SET($1);IANNNO^SET($2);IPOSX^SET($3);IPOSY^SET($4);ISTARTTIME^SET(RANDOM^GET(4));SFIELDFROM^SET(ARRMAPABKG^GET([[IPOSY*ISIZEX]+IPOSX]));ANNENEMY^LOAD(["ENEMY"+IANNNO+".ANN"]);ANNENEMY^SETFPS(40);ANNENEMY^SETPOSITION([IPOSX*IGRID],[IPOSY*IGRID]);ANNENEMY^PLAY("IDLE");}


OBJECT=MOVE
MOVE:TYPE=BEHAVIOUR
MOVE:CODE={ANNENEMY^MOVE($1,$2);}


OBJECT=DEAD
DEAD:TYPE=BEHAVIOUR
DEAD:CODE={SDIRSEL^SET(NULL);ANNENEMY^STOP(FALSE);IENEMYTYPE^SET(IANNNO);SEVENTDEAD^SET(ANNENEMY^GETEVENTNAME());}


OBJECT=PAUSE
PAUSE:TYPE=BEHAVIOUR
PAUSE:CODE={ANNENEMY^PAUSE();}


OBJECT=RESUME
RESUME:TYPE=BEHAVIOUR
RESUME:CODE={ANNENEMY^RESUME();}


OBJECT=NOCOLL
NOCOLL:TYPE=BEHAVIOUR
NOCOLL:CODE={SFIELD^REMOVEBEHAVIOUR("ONBRUTALCHANGED$PLAYER");}


OBJECT=BFITMP195
BFITMP195:TYPE=BEHAVIOUR
BFITMP195:CODE={SDIRSEL^SET("U");}


OBJECT=BFITMP196
BFITMP196:TYPE=BEHAVIOUR
BFITMP196:CODE={SDIRSEL^SET("R");}


OBJECT=BFITMP197
BFITMP197:TYPE=BEHAVIOUR
BFITMP197:CODE={SDIRSEL^SET("D");}


OBJECT=BFITMP198
BFITMP198:TYPE=BEHAVIOUR
BFITMP198:CODE={SDIRSEL^SET("D");}


OBJECT=BFITMP199
BFITMP199:TYPE=BEHAVIOUR
BFITMP199:CODE={SDIRSEL^SET("L");}


OBJECT=BFITMP200
BFITMP200:TYPE=BEHAVIOUR
BFITMP200:CODE={SDIRSEL^SET("U");}


OBJECT=BFITMP201
BFITMP201:TYPE=BEHAVIOUR
BFITMP201:CODE={SDIRSEL^SET("L");}


OBJECT=BFITMP202
BFITMP202:TYPE=BEHAVIOUR
BFITMP202:CODE={SDIRSEL^SET("U");}


OBJECT=BFITMP203
BFITMP203:TYPE=BEHAVIOUR
BFITMP203:CODE={SDIRSEL^SET("R");}


OBJECT=BFITMP204
BFITMP204:TYPE=BEHAVIOUR
BFITMP204:CODE={SDIRSEL^SET("R");}


OBJECT=BFITMP205
BFITMP205:TYPE=BEHAVIOUR
BFITMP205:CODE={SDIRSEL^SET("D");}


OBJECT=BFITMP206
BFITMP206:TYPE=BEHAVIOUR
BFITMP206:CODE={SDIRSEL^SET("L");}


OBJECT=BFITMP207
BFITMP207:TYPE=BEHAVIOUR
BFITMP207:CODE={SDIRSELIDLE^SET("R");}


OBJECT=BFITMP208
BFITMP208:TYPE=BEHAVIOUR
BFITMP208:CODE={SDIRSELIDLE^SET("D");}


OBJECT=BFITMP209
BFITMP209:TYPE=BEHAVIOUR
BFITMP209:CODE={SDIRSELIDLE^SET("L");}


OBJECT=BFITMP210
BFITMP210:TYPE=BEHAVIOUR
BFITMP210:CODE={ANNENEMY^PLAY("IDLE");}


OBJECT=BFITMP211
BFITMP211:TYPE=BEHAVIOUR
BFITMP211:CODE={SDIRSELIDLE^SET("U");@IF("SDIRSEL","!_","NULL","BFITMP207","");@IF("SDIRSEL","!_","NULL","BFITMP208","");@IF("SDIRSEL","!_","NULL","BFITMP209","");@IF("SDIRSEL!'NULL&&ANNENEMY^ISPLAYING()'FALSE","BFITMP210","");}


OBJECT=BFITMP212
BFITMP212:TYPE=BEHAVIOUR
BFITMP212:CODE={ISTARTTIME^DEC();ANNENEMY^PLAY("IDLE");}


