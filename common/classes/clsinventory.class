OBJECT=D1
D1:TYPE=DOUBLE

OBJECT=D2
D2:TYPE=DOUBLE

OBJECT=D3
D3:TYPE=DOUBLE

OBJECT=I1
I1:TYPE=INTEGER

OBJECT=I2
I2:TYPE=INTEGER

OBJECT=I3
I3:TYPE=INTEGER

OBJECT=S1
S1:TYPE=STRING

OBJECT=S2
S2:TYPE=STRING

OBJECT=IITEMSCNT
IITEMSCNT:TYPE=INTEGER
IITEMSCNT:VALUE=0

OBJECT=SINVSTRING
SINVSTRING:TYPE=STRING

OBJECT=DOPACITY
DOPACITY:TYPE=DOUBLE
DOPACITY:VALUE=0.0

OBJECT=IRADIUS
IRADIUS:TYPE=INTEGER
IRADIUS:VALUE=0

OBJECT=IDIR
IDIR:TYPE=INTEGER
IDIR:VALUE=0

OBJECT=IINVCENTERX
IINVCENTERX:TYPE=INTEGER
IINVCENTERX:VALUE=0

OBJECT=IINVCENTERY
IINVCENTERY:TYPE=INTEGER
IINVCENTERY:VALUE=0

OBJECT=IINVDELTAX
IINVDELTAX:TYPE=INTEGER
IINVDELTAX:VALUE=0

OBJECT=IINVDELTAY
IINVDELTAY:TYPE=INTEGER
IINVDELTAY:VALUE=0

OBJECT=IINVDELTAADDX
IINVDELTAADDX:TYPE=INTEGER
IINVDELTAADDX:VALUE=0

OBJECT=IINVDELTAADDY
IINVDELTAADDY:TYPE=INTEGER
IINVDELTAADDY:VALUE=0

OBJECT=ANNSLOT
ANNSLOT:TYPE=ANIMO
ANNSLOT:VISIBLE=FALSE
ANNSLOT:FILENAME=$COMMON\INV_SLOT.ANN
ANNSLOT:TOCANVAS=TRUE
ANNSLOT:PRIORITY=20010
ANNSLOT:FPS=16
ANNSLOT:PRELOAD=TRUE
ANNSLOT:RELEASE=TRUE
ANNSLOT:MONITORCOLLISION=FALSE
ANNSLOT:MONITORCOLLISIONALPHA=FALSE

OBJECT=ANNITEM
ANNITEM:TYPE=ANIMO
ANNITEM:VISIBLE=FALSE
ANNITEM:FILENAME=$DANE\GAME\PRZYGODA\ARCADE\INV_ITEMS.ANN
ANNITEM:TOCANVAS=TRUE
ANNITEM:PRIORITY=20020
ANNITEM:FPS=16
ANNITEM:PRELOAD=TRUE
ANNITEM:RELEASE=TRUE
ANNITEM:MONITORCOLLISION=FALSE
ANNITEM:MONITORCOLLISIONALPHA=FALSE

OBJECT=ANNRUNNER
ANNRUNNER:TYPE=ANIMO
ANNRUNNER:VISIBLE=TRUE
ANNRUNNER:FILENAME=$COMMON\INV_RUNNER.ANN
ANNRUNNER:TOCANVAS=TRUE
ANNRUNNER:PRIORITY=0
ANNRUNNER:FPS=32
ANNRUNNER:PRELOAD=TRUE
ANNRUNNER:RELEASE=TRUE
ANNRUNNER:MONITORCOLLISION=FALSE
ANNRUNNER:MONITORCOLLISIONALPHA=FALSE
ANNRUNNER:ONFRAMECHANGED={IRADIUS^ADD([17*IDIR]);DOPACITY^ADD([42.5*IDIR]);PLACEGFX^RUN();@IF("IRADIUS",">_","102","BFITMP135","");@IF("IRADIUS","_","0","BFITMP136","");}

OBJECT=BUTNULL
BUTNULL:TYPE=BUTTON
BUTNULL:VISIBLE=TRUE
BUTNULL:RECT=0,0,800,600
BUTNULL:ENABLE=FALSE
BUTNULL:DRAGGABLE=FALSE
BUTNULL:ONCLICKED={ZWIN^RUN();}

OBJECT=BUTITEM0
BUTITEM0:TYPE=BUTTON
BUTITEM0:VISIBLE=TRUE
BUTITEM0:ENABLE=FALSE
BUTITEM0:DRAGGABLE=FALSE
BUTITEM0:ONCLICKED={SITEMDRAGGING^SET(ARRINVENTORY^GET(0));ANNSLOT^PREVFRAME();ZWIN^RUN();}
BUTITEM0:ONFOCUSON={ANNSLOT^NEXTFRAME();}
BUTITEM0:ONFOCUSOFF={ANNSLOT^PREVFRAME();}

OBJECT=BUTITEM1
BUTITEM1:TYPE=BUTTON
BUTITEM1:VISIBLE=TRUE
BUTITEM1:ENABLE=FALSE
BUTITEM1:DRAGGABLE=FALSE
BUTITEM1:ONCLICKED={SITEMDRAGGING^SET(ARRINVENTORY^GET(1));ANNSLOT_1^PREVFRAME();ZWIN^RUN();}
BUTITEM1:ONFOCUSON={ANNSLOT_1^NEXTFRAME();}
BUTITEM1:ONFOCUSOFF={ANNSLOT_1^PREVFRAME();}

OBJECT=BUTITEM2
BUTITEM2:TYPE=BUTTON
BUTITEM2:VISIBLE=TRUE
BUTITEM2:ENABLE=FALSE
BUTITEM2:DRAGGABLE=FALSE
BUTITEM2:ONCLICKED={SITEMDRAGGING^SET(ARRINVENTORY^GET(2));ANNSLOT_2^PREVFRAME();ZWIN^RUN();}
BUTITEM2:ONFOCUSON={ANNSLOT_2^NEXTFRAME();}
BUTITEM2:ONFOCUSOFF={ANNSLOT_2^PREVFRAME();}

OBJECT=BUTITEM3
BUTITEM3:TYPE=BUTTON
BUTITEM3:VISIBLE=TRUE
BUTITEM3:ENABLE=FALSE
BUTITEM3:DRAGGABLE=FALSE
BUTITEM3:ONCLICKED={SITEMDRAGGING^SET(ARRINVENTORY^GET(3));ANNSLOT_3^PREVFRAME();ZWIN^RUN();}
BUTITEM3:ONFOCUSON={ANNSLOT_3^NEXTFRAME();}
BUTITEM3:ONFOCUSOFF={ANNSLOT_3^PREVFRAME();}

OBJECT=BUTITEM4
BUTITEM4:TYPE=BUTTON
BUTITEM4:VISIBLE=TRUE
BUTITEM4:ENABLE=FALSE
BUTITEM4:DRAGGABLE=FALSE
BUTITEM4:ONCLICKED={SITEMDRAGGING^SET(ARRINVENTORY^GET(4));ANNSLOT_4^PREVFRAME();ZWIN^RUN();}
BUTITEM4:ONFOCUSON={ANNSLOT_4^NEXTFRAME();}
BUTITEM4:ONFOCUSOFF={ANNSLOT_4^PREVFRAME();}

OBJECT=BUTITEM5
BUTITEM5:TYPE=BUTTON
BUTITEM5:VISIBLE=TRUE
BUTITEM5:ENABLE=FALSE
BUTITEM5:DRAGGABLE=FALSE
BUTITEM5:ONCLICKED={SITEMDRAGGING^SET(ARRINVENTORY^GET(5));ANNSLOT_5^PREVFRAME();ZWIN^RUN();}
BUTITEM5:ONFOCUSON={ANNSLOT_5^NEXTFRAME();}
BUTITEM5:ONFOCUSOFF={ANNSLOT_5^PREVFRAME();}

OBJECT=BUTITEM6
BUTITEM6:TYPE=BUTTON
BUTITEM6:VISIBLE=TRUE
BUTITEM6:ENABLE=FALSE
BUTITEM6:DRAGGABLE=FALSE
BUTITEM6:ONCLICKED={SITEMDRAGGING^SET(ARRINVENTORY^GET(6));ANNSLOT_6^PREVFRAME();ZWIN^RUN();}
BUTITEM6:ONFOCUSON={ANNSLOT_6^NEXTFRAME();}
BUTITEM6:ONFOCUSOFF={ANNSLOT_6^PREVFRAME();}

OBJECT=BUTITEM7
BUTITEM7:TYPE=BUTTON
BUTITEM7:VISIBLE=TRUE
BUTITEM7:ENABLE=FALSE
BUTITEM7:DRAGGABLE=FALSE
BUTITEM7:ONCLICKED={SITEMDRAGGING^SET(ARRINVENTORY^GET(7));ANNSLOT_7^PREVFRAME();ZWIN^RUN();}
BUTITEM7:ONFOCUSON={ANNSLOT_7^NEXTFRAME();}
BUTITEM7:ONFOCUSOFF={ANNSLOT_7^PREVFRAME();}

OBJECT=BUTITEM8
BUTITEM8:TYPE=BUTTON
BUTITEM8:VISIBLE=TRUE
BUTITEM8:ENABLE=FALSE
BUTITEM8:DRAGGABLE=FALSE
BUTITEM8:ONCLICKED={SITEMDRAGGING^SET(ARRINVENTORY^GET(8));ANNSLOT_8^PREVFRAME();ZWIN^RUN();}
BUTITEM8:ONFOCUSON={ANNSLOT_8^NEXTFRAME();}
BUTITEM8:ONFOCUSOFF={ANNSLOT_8^PREVFRAME();}

OBJECT=BUTITEM9
BUTITEM9:TYPE=BUTTON
BUTITEM9:VISIBLE=TRUE
BUTITEM9:ENABLE=FALSE
BUTITEM9:DRAGGABLE=FALSE
BUTITEM9:ONCLICKED={SITEMDRAGGING^SET(ARRINVENTORY^GET(9));ANNSLOT_9^PREVFRAME();ZWIN^RUN();}
BUTITEM9:ONFOCUSON={ANNSLOT_9^NEXTFRAME();}
BUTITEM9:ONFOCUSOFF={ANNSLOT_9^PREVFRAME();}

OBJECT=SFX_THING
SFX_THING:TYPE=SOUND
SFX_THING:FILENAME=SFX_THING.WAV
SFX_THING:PRELOAD=FALSE
SFX_THING:FLUSHAFTERPLAYED=FALSE

OBJECT=ARRINVENTORY
ARRINVENTORY:TYPE=ARRAY

OBJECT=CONSTRUCTOR
CONSTRUCTOR:TYPE=BEHAVIOUR
CONSTRUCTOR:CODE={LOAD^RUN();BUTNULL^SETPRIORITY(20000);ANNSLOT^CLONE(9);ANNITEM^CLONE(9);}


OBJECT=LOAD
LOAD:TYPE=BEHAVIOUR
LOAD:CODE={SINVSTRING^SET(GSAVE^GET("INVENTORY"));ARRINVENTORY^REMOVEALL();@INT("ITMPL",SINVSTRING^FIND("<",0));@INT("ITMPR",SINVSTRING^FIND(">",0));@STRING("STMPITEM","");IITEMSCNT^SET(0);@WHILE("ITMPL",">","-1","{ITMPL^INC();STMPITEM^SET(SINVSTRING^GET(ITMPL,[ITMPR-ITMPL]));ARRINVENTORY^ADD(STMPITEM);IITEMSCNT^INC();ITMPR^INC();ITMPL^SET(SINVSTRING^FIND("<",ITMPL));ITMPR^SET(SINVSTRING^FIND(">",ITMPR));}");}


OBJECT=EMPTY
EMPTY:TYPE=BEHAVIOUR
EMPTY:CODE={IITEMSCNT^SET(0);ARRINVENTORY^REMOVEALL();SINVSTRING^SET("");GSAVE^SET("INVENTORY",SINVSTRING);}


OBJECT=ADD
ADD:TYPE=BEHAVIOUR
ADD:CODE={@STRING("SINVTMP0",$1);@IF(ARRINVENTORY^GETSIZE(),"<","10","BFITMP139","BFITMP140");}


OBJECT=REMOVE
REMOVE:TYPE=BEHAVIOUR
REMOVE:CODE={@STRING("SINVTMP0",$1);@INT("ITMP0",ARRINVENTORY^FIND(SINVTMP0));@INT("ITMP1",0);@IF("ITMP0",">","-1","BFITMP141","BFITMP142");}


OBJECT=CHECK
CHECK:TYPE=BEHAVIOUR
CHECK:CODE={@STRING("SINVTMP0",$1);@INT("ITMP0",ARRINVENTORY^FIND(SINVTMP0));@IF("ITMP0",">","-1","BFITMP143","BFITMP144");}


OBJECT=ROZWIN
ROZWIN:TYPE=BEHAVIOUR
ROZWIN:CODE={IINVCENTERX^SET($1);IINVCENTERY^SET($2);@IF(ARRINVENTORY^GETSIZE(),">","0","BFITMP145","");}


OBJECT=ZWIN
ZWIN:TYPE=BEHAVIOUR
ZWIN:CODE={BUTNULL^DISABLE();DISABLEBUTTONS^RUN();IDIR^SET(-1);ANNRUNNER^PLAY("ELAPSE");}


OBJECT=_____
_____:TYPE=BEHAVIOUR
_____:CODE={}


OBJECT=PLACEGFX
PLACEGFX:TYPE=BEHAVIOUR
PLACEGFX:CODE={IINVDELTAADDX^ADD([IINVDELTAX*IDIR]);IINVDELTAADDY^ADD([IINVDELTAY*IDIR]);@LOOP("{I3^SET(_I_);D3^SET([36.0*I3]);D3^SUB([[IITEMSCNT-1]*18]);D1^SINUS(D3);D2^COSINUS(D3);D1^MUL(IRADIUS);D2^MUL([0-IRADIUS]);S1^SET(["ANNSLOT_"+I3]);S2^SET(["ANNITEM_"+I3]);*S1^SETOPACITY(DOPACITY);*S2^SETOPACITY(DOPACITY);*S1^SETPOSITION([D1+IINVCENTERX+IINVDELTAADDX],[D2+IINVCENTERY+IINVDELTAADDY]);*S2^SETPOSITION([D1+IINVCENTERX+IINVDELTAADDX],[D2+IINVCENTERY+IINVDELTAADDY]);}",0,IITEMSCNT,1);}


OBJECT=ENABLEBUTTONS
ENABLEBUTTONS:TYPE=BEHAVIOUR
ENABLEBUTTONS:CODE={@LOOP("{S1^SET(["BUTITEM"+_I_]);S2^SET(["ANNSLOT_"+_I_]);*S1^SETRECT(S2);*S1^SETPRIORITY(20010);*S1^ENABLE();*S2^SHOW();}",0,IITEMSCNT,1);}


OBJECT=DISABLEBUTTONS
DISABLEBUTTONS:TYPE=BEHAVIOUR
DISABLEBUTTONS:CODE={@LOOP("{S1^SET(["BUTITEM"+_I_]);*S1^DISABLE();}",0,IITEMSCNT,1);}


OBJECT=BFITMP135
BFITMP135:TYPE=BEHAVIOUR
BFITMP135:CODE={ANNRUNNER^STOP(FALSE);ENABLEBUTTONS^RUN();}


OBJECT=BFITMP136
BFITMP136:TYPE=BEHAVIOUR
BFITMP136:CODE={ANNRUNNER^STOP(FALSE);@LOOP("{S1^SET(["ANNSLOT_"+_I_]);S2^SET(["ANNITEM_"+_I_]);*S1^HIDE();*S2^HIDE();}",0,IITEMSCNT,1);}


OBJECT=BFITMP137
BFITMP137:TYPE=BEHAVIOUR
BFITMP137:CODE={IITEMSCNT^INC();ARRINVENTORY^ADD(SINVTMP0);SINVSTRING^ADD(["<"+SINVTMP0+">"]);GSAVE^SET("INVENTORY",SINVSTRING);@RETURN("DONE");SFX_THING^PLAY();}


OBJECT=BFITMP138
BFITMP138:TYPE=BEHAVIOUR
BFITMP138:CODE={@RETURN("ERR_ALR");}


OBJECT=BFITMP139
BFITMP139:TYPE=BEHAVIOUR
BFITMP139:CODE={@IF(ARRINVENTORY^FIND(SINVTMP0),"_","-1","BFITMP137","BFITMP138");}


OBJECT=BFITMP140
BFITMP140:TYPE=BEHAVIOUR
BFITMP140:CODE={@RETURN("ERR_OVR");}


OBJECT=BFITMP141
BFITMP141:TYPE=BEHAVIOUR
BFITMP141:CODE={IITEMSCNT^DEC();ARRINVENTORY^REMOVEAT(ITMP0);ITMP0^SET(SINVSTRING^FIND(["<"+SINVTMP0+">"]));ITMP1^SET([SINVTMP0^LENGTH()+2]);SINVSTRING^SUB(ITMP0,ITMP1);GSAVE^SET("INVENTORY",SINVSTRING);SFX_THING^PLAY();}


OBJECT=BFITMP142
BFITMP142:TYPE=BEHAVIOUR
BFITMP142:CODE={}


OBJECT=BFITMP143
BFITMP143:TYPE=BEHAVIOUR
BFITMP143:CODE={@RETURN(TRUE);}


OBJECT=BFITMP144
BFITMP144:TYPE=BEHAVIOUR
BFITMP144:CODE={@RETURN(FALSE);}


OBJECT=BFITMP145
BFITMP145:TYPE=BEHAVIOUR
BFITMP145:CODE={IINVDELTAX^SET(IINVCENTERX);IINVDELTAY^SET(IINVCENTERY);IINVDELTAX^CLAMP(140,660);IINVDELTAY^CLAMP(140,460);IINVDELTAX^SET([IINVDELTAX-IINVCENTERX]);IINVDELTAY^SET([IINVDELTAY-IINVCENTERY]);IINVDELTAX^DIV(6);IINVDELTAY^DIV(6);BUTNULL^ENABLE();IDIR^SET(1);@LOOP("{S1^SET(["ANNSLOT_"+_I_]);S2^SET(["ANNITEM_"+_I_]);*S1^SHOW();*S2^SHOW();*S2^SETFRAME(ARRINVENTORY^GET(_I_),0);}",0,IITEMSCNT,1);ANNRUNNER^PLAY("ELAPSE");}


