OBJECT=MUSIC
MUSIC:TYPE=MUSIC
MUSIC:FILENAME=WIEZA.WAV

OBJECT=IGRIDX
IGRIDX:TYPE=INTEGER
IGRIDX:VALUE=75

OBJECT=IGRIDY
IGRIDY:TYPE=INTEGER
IGRIDY:VALUE=28

OBJECT=ILX
ILX:TYPE=INTEGER

OBJECT=ILY
ILY:TYPE=INTEGER

OBJECT=IWX
IWX:TYPE=INTEGER

OBJECT=IWY
IWY:TYPE=INTEGER

OBJECT=IACCWX
IACCWX:TYPE=INTEGER

OBJECT=IACCWY
IACCWY:TYPE=INTEGER

OBJECT=IACCLX
IACCLX:TYPE=INTEGER

OBJECT=IACCLY
IACCLY:TYPE=INTEGER

OBJECT=ICX
ICX:TYPE=INTEGER

OBJECT=ICY
ICY:TYPE=INTEGER

OBJECT=INX
INX:TYPE=INTEGER

OBJECT=INY
INY:TYPE=INTEGER

OBJECT=SLASTTRACK
SLASTTRACK:TYPE=STRING

OBJECT=SCURTRACK
SCURTRACK:TYPE=STRING

OBJECT=SCORRECTXY
SCORRECTXY:TYPE=STRING
SCORRECTXY:ONBRUTALCHANGED^RR={IWX^SET(ILX);IWY^SET(ILY);ILX^INC();}
SCORRECTXY:ONBRUTALCHANGED^RD={IWX^SET(ILX);IWY^SET(ILY);ILY^INC();}
SCORRECTXY:ONBRUTALCHANGED^RU={IWX^SET(ILX);IWY^SET(ILY);ILY^DEC();}
SCORRECTXY:ONBRUTALCHANGED^DD={IWX^SET(ILX);IWY^SET(ILY);ILY^INC();}
SCORRECTXY:ONBRUTALCHANGED^DR={IWX^SET(ILX);IWY^SET(ILY);ILX^INC();}
SCORRECTXY:ONBRUTALCHANGED^UU={IWX^SET(ILX);IWY^SET(ILY);ILY^DEC();}
SCORRECTXY:ONBRUTALCHANGED^UR={IWX^SET(ILX);IWY^SET(ILY);ILX^INC();}
SCORRECTXY:ONBRUTALCHANGED^UL={IWX^SET(ILX);IWY^SET(ILY);ILX^DEC();}
SCORRECTXY:ONBRUTALCHANGED^LU={IWX^SET(ILX);IWY^SET(ILY);ILY^DEC();}
SCORRECTXY:ONBRUTALCHANGED^LL={IWX^SET(ILX);IWY^SET(ILY);ILX^DEC();}
SCORRECTXY:ONBRUTALCHANGED^LD={IWX^SET(ILX);IWY^SET(ILY);ILY^INC();}
SCORRECTXY:ONBRUTALCHANGED^DL={IWX^SET(ILX);IWY^SET(ILY);ILX^DEC();}

OBJECT=ILASTX
ILASTX:TYPE=INTEGER

OBJECT=ILASTY
ILASTY:TYPE=INTEGER

OBJECT=ILASTWX
ILASTWX:TYPE=INTEGER

OBJECT=ILASTWY
ILASTWY:TYPE=INTEGER

OBJECT=IDRAGX
IDRAGX:TYPE=INTEGER

OBJECT=IDRAGY
IDRAGY:TYPE=INTEGER

OBJECT=BLOCK
BLOCK:TYPE=BOOL

OBJECT=SLOCKED
SLOCKED:TYPE=STRING

OBJECT=IMAXX
IMAXX:TYPE=INTEGER

OBJECT=IMAXY
IMAXY:TYPE=INTEGER

OBJECT=BSTATE
BSTATE:TYPE=BOOL

OBJECT=IFAKEX
IFAKEX:TYPE=INTEGER

OBJECT=IFAKEWX
IFAKEWX:TYPE=INTEGER

OBJECT=SLEVETAP
SLEVETAP:TYPE=STRING

OBJECT=BKRAKSA
BKRAKSA:TYPE=INTEGER

OBJECT=IMAXETAP
IMAXETAP:TYPE=INTEGER

OBJECT=BEND
BEND:TYPE=BOOL

OBJECT=ILASTD0X
ILASTD0X:TYPE=INTEGER

OBJECT=ILASTD0Y
ILASTD0Y:TYPE=INTEGER

OBJECT=IACCDX
IACCDX:TYPE=INTEGER

OBJECT=IACCDY
IACCDY:TYPE=INTEGER

OBJECT=IOFFSETY
IOFFSETY:TYPE=INTEGER

OBJECT=IKOLEJETAP
IKOLEJETAP:TYPE=INTEGER

OBJECT=IKOLEJLEVEL
IKOLEJLEVEL:TYPE=INTEGER

OBJECT=BFAILED
BFAILED:TYPE=INTEGER

OBJECT=BRET
BRET:TYPE=BOOL

OBJECT=ANLOCO
ANLOCO:TYPE=ANIMO
ANLOCO:VISIBLE=FALSE
ANLOCO:FILENAME=
ANLOCO:TOCANVAS=TRUE
ANLOCO:PRIORITY=10
ANLOCO:FPS=1
ANLOCO:PRELOAD=TRUE
ANLOCO:RELEASE=TRUE
ANLOCO:MONITORCOLLISION=FALSE
ANLOCO:MONITORCOLLISIONALPHA=FALSE

OBJECT=ANTRACK
ANTRACK:TYPE=ANIMO
ANTRACK:VISIBLE=FALSE
ANTRACK:FILENAME=TR.ANN
ANTRACK:TOCANVAS=TRUE
ANTRACK:PRIORITY=1
ANTRACK:FPS=1
ANTRACK:PRELOAD=TRUE
ANTRACK:RELEASE=TRUE
ANTRACK:MONITORCOLLISION=FALSE
ANTRACK:MONITORCOLLISIONALPHA=FALSE

OBJECT=ANPFW
ANPFW:TYPE=ANIMO
ANPFW:VISIBLE=TRUE
ANPFW:FILENAME=W0.ANN
ANPFW:TOCANVAS=TRUE
ANPFW:PRIORITY=1
ANPFW:FPS=2
ANPFW:PRELOAD=TRUE
ANPFW:RELEASE=TRUE
ANPFW:MONITORCOLLISION=FALSE
ANPFW:MONITORCOLLISIONALPHA=FALSE

OBJECT=ANBLANK8
ANBLANK8:TYPE=ANIMO
ANBLANK8:VISIBLE=TRUE
ANBLANK8:FILENAME=BLANK8.ANN
ANBLANK8:TOCANVAS=TRUE
ANBLANK8:PRIORITY=0
ANBLANK8:FPS=15
ANBLANK8:PRELOAD=TRUE
ANBLANK8:RELEASE=TRUE
ANBLANK8:MONITORCOLLISION=FALSE
ANBLANK8:MONITORCOLLISIONALPHA=FALSE
ANBLANK8:ONFRAMECHANGED={@STRING("ST","");@INT("CF",0);@INT("LDX",0);@INT("LDY",0);@INT("WDX",0);@INT("WDY",0);@INT("DDX",0);@INT("DDY",0);@INT("IX",0);@INT("IY",0);@INT("IX2",0);@INT("IY2",0);@INT("IX3",0);@INT("IY3",0);@IF(SFX_KOLEJ_RUN^ISPLAYING(),"_","FALSE","BFITMP0","");CF^SET(ANBLANK8^GETCFRAMEINEVENT());ANLOCO^SETFRAME(SCURTRACK,CF);ANPFW^SETFRAME(SLASTTRACK,CF);ANLPOS^SETFRAME(SCURTRACK,[CF@2]);IX^SET(ANLOCO^GETCURRFRAMEPOSX());IY^SET(ANLOCO^GETCURRFRAMEPOSY());LDX^SET([IX-ILASTX]);LDY^SET([IY-ILASTY]);IX2^SET(ANPFW^GETCURRFRAMEPOSX());IY2^SET(ANPFW^GETCURRFRAMEPOSY());WDX^SET([IX2-ILASTWX]);WDY^SET([IY2-ILASTWY]);IX3^SET(ANLPOS^GETCURRFRAMEPOSX());IY3^SET(ANLPOS^GETCURRFRAMEPOSY());DDX^SET([IX3-ILASTD0X]);DDY^SET([IXY-ILASTD0Y]);IACCLX^ADD(LDX);IACCLY^ADD(LDY);IACCWX^ADD(WDX);IACCWY^ADD(WDY);@IF("ILX'1||ILX'2","BFITMP1","");ANLOCO^SETPOSITION([ICX-IX],[ICY-IY+IACCLY]);@INT("LLX",ANLOCO^GETPOSITIONX(TRUE));@INT("LLY",ANLOCO^GETPOSITIONY(TRUE));ANLPOS^SETPOSITION(LLX,LLY);ANLPOS^MOVE(DDX,DDY);@IF(SLASTTRACK^GET(0),"_",SLASTTRACK^GET(1),"BFITMP2","");@IF("SLASTTRACK'"RD"||SLASTTRACK'"RU"","BFITMP3","");@IF("SLASTTRACK'"LD"||SLASTTRACK'"LU"","BFITMP4","");@IF("SLASTTRACK'"DR"||SLASTTRACK'"UR"","BFITMP5","");@IF("SLASTTRACK'"DL"||SLASTTRACK'"UL"","BFITMP6","");CANVASOBSERVER^MOVEBKG(LDX,0);@LOOP("{ST^SET(ARTRACK^GET(_I_));*ST^MOVE([0-LDX],0);}",0,ARTRACK^GETSIZE(),1);ILASTX^SET(IX);ILASTY^SET(IY);ILASTWX^SET(IX2);ILASTWY^SET(IY2);ILASTD0X^SET(IX3);ILASTD0Y^SET(IY3);@IF("CF'8&&BSTATE'TRUE","BFITMP9","");@IF("CF'8&&BEND'TRUE","BFITMP10","");@STRING("STB",ANLOCO^GETEVENTNAME());@IF("CF'8&&ILX'5&&ILY'9&&STB^GET(1)'"L"","BFITMP11","");GRDYM^MOVE([0-LDX],0);@STRING("SSS","");@LOOP("{SSS^SET(["ANDYM_"+_I_]);@IF(*SSS^ISPLAYING(),"_","FALSE","BFITMP12","");}",0,59,1);}
ANBLANK8:ONFINISHED={@INT("IX",0);@INT("IY",0);@INT("MX",0);@INT("MY",0);@BOOL("G",FALSE);@IF("SLASTTRACK'"RD"||SLASTTRACK'"RU"","BFITMP13","");@IF("SLASTTRACK'"DR"||SLASTTRACK'"UR"","BFITMP14","");@IF("SLASTTRACK'"LD"||SLASTTRACK'"LU"","BFITMP15","");@IF("SLASTTRACK'"DL"||SLASTTRACK'"UL"","BFITMP16","");SLASTTRACK^SET(SCURTRACK);SCORRECTXY^SET(SCURTRACK);BEHNEXTMOVE^RUN();ANLOCO^SETFRAME(SCURTRACK,0);ANPFW^SETFRAME(SLASTTRACK,0);ANLPOS^SETFRAME(SCURTRACK,0);ILASTX^SET(ANLOCO^GETCURRFRAMEPOSX());ILASTY^SET(ANLOCO^GETCURRFRAMEPOSY());ILASTWX^SET(ANPFW^GETCURRFRAMEPOSX());ILASTWY^SET(ANPFW^GETCURRFRAMEPOSY());ILASTD0X^SET(ANLPOS^GETCURRFRAMEPOSX());ILASTD0Y^SET(ANLPOS^GETCURRFRAMEPOSY());IACCWX^SET(0);ANBLANK8^PLAY("TIMER16");ANBLANK8^SETFRAME("TIMER16",1);}

OBJECT=ANTRSTAT
ANTRSTAT:TYPE=ANIMO
ANTRSTAT:VISIBLE=FALSE
ANTRSTAT:FILENAME=TRS.ANN
ANTRSTAT:TOCANVAS=TRUE
ANTRSTAT:PRIORITY=1
ANTRSTAT:FPS=16
ANTRSTAT:PRELOAD=TRUE
ANTRSTAT:RELEASE=TRUE
ANTRSTAT:MONITORCOLLISION=FALSE
ANTRSTAT:MONITORCOLLISIONALPHA=FALSE

OBJECT=ANSTATION
ANSTATION:TYPE=ANIMO
ANSTATION:VISIBLE=FALSE
ANSTATION:FILENAME=BLANK_STATE.ANN
ANSTATION:TOCANVAS=TRUE
ANSTATION:PRIORITY=0
ANSTATION:FPS=2
ANSTATION:PRELOAD=TRUE
ANSTATION:RELEASE=TRUE
ANSTATION:MONITORCOLLISION=FALSE
ANSTATION:MONITORCOLLISIONALPHA=FALSE
ANSTATION:ONSTARTED={SFX_KOLEJ_RUN^STOP(FALSE);}
ANSTATION:ONFINISHED={BSTATE^SET(FALSE);ANBLANK8^RESUME();SFX_KOLEJ_START^PLAY();SFX_KOLEJ_STEAM^PLAY();SFX_KOLEJ_RUN^PLAY();}

OBJECT=BLANK5
BLANK5:TYPE=ANIMO
BLANK5:VISIBLE=TRUE
BLANK5:FILENAME=BLANK5.ANN
BLANK5:TOCANVAS=TRUE
BLANK5:PRIORITY=0
BLANK5:FPS=15
BLANK5:PRELOAD=TRUE
BLANK5:RELEASE=TRUE
BLANK5:MONITORCOLLISION=FALSE
BLANK5:MONITORCOLLISIONALPHA=FALSE
BLANK5:ONFRAMECHANGED={@INT("CF",0);@IF(SFX_KOLEJ_RUN^ISPLAYING(),"_","FALSE","BFITMP17","");@IF("BRET","_","TRUE","BFITMP21","BFITMP22");@STRING("SSS","");@LOOP("{SSS^SET(["ANDYM_"+_I_]);@IF(*SSS^ISPLAYING(),"_","FALSE","BFITMP23","");}",0,59,1);}
BLANK5:ONFINISHED={@IF("BRET","_","FALSE","BFITMP25","BFITMP26");}

OBJECT=ANFADE
ANFADE:TYPE=ANIMO
ANFADE:VISIBLE=TRUE
ANFADE:FILENAME=ANFADE.ANN
ANFADE:TOCANVAS=TRUE
ANFADE:PRIORITY=1000
ANFADE:FPS=16
ANFADE:PRELOAD=TRUE
ANFADE:RELEASE=TRUE
ANFADE:MONITORCOLLISION=FALSE
ANFADE:MONITORCOLLISIONALPHA=FALSE
ANFADE:ONFINISHED^CLOSE={SFX_KOLEJ_RUN^STOP(FALSE);}

OBJECT=ANLPOS
ANLPOS:TYPE=ANIMO
ANLPOS:VISIBLE=FALSE
ANLPOS:FILENAME=D0.ANN
ANLPOS:TOCANVAS=TRUE
ANLPOS:PRIORITY=100
ANLPOS:FPS=16
ANLPOS:PRELOAD=TRUE
ANLPOS:RELEASE=TRUE
ANLPOS:MONITORCOLLISION=FALSE
ANLPOS:MONITORCOLLISIONALPHA=FALSE

OBJECT=ANDYM
ANDYM:TYPE=ANIMO
ANDYM:VISIBLE=FALSE
ANDYM:FILENAME=DYM.ANN
ANDYM:TOCANVAS=TRUE
ANDYM:PRIORITY=50
ANDYM:FPS=3
ANDYM:PRELOAD=TRUE
ANDYM:RELEASE=TRUE
ANDYM:MONITORCOLLISION=FALSE
ANDYM:MONITORCOLLISIONALPHA=FALSE
ANDYM:ONFINISHED={@STRING("SOB","");SOB^SET(THIS^GETNAME());*SOB^HIDE();}

OBJECT=IMGMAPA11
IMGMAPA11:TYPE=IMAGE
IMGMAPA11:VISIBLE=FALSE
IMGMAPA11:FILENAME=IMGMAPA11.IMG
IMGMAPA11:TOCANVAS=TRUE
IMGMAPA11:PRIORITY=100
IMGMAPA11:PRELOAD=TRUE
IMGMAPA11:RELEASE=TRUE
IMGMAPA11:MONITORCOLLISION=FALSE
IMGMAPA11:MONITORCOLLISIONALPHA=FALSE

OBJECT=IMGMAPA12
IMGMAPA12:TYPE=IMAGE
IMGMAPA12:VISIBLE=FALSE
IMGMAPA12:FILENAME=IMGMAPA12.IMG
IMGMAPA12:TOCANVAS=TRUE
IMGMAPA12:PRIORITY=100
IMGMAPA12:PRELOAD=TRUE
IMGMAPA12:RELEASE=TRUE
IMGMAPA12:MONITORCOLLISION=FALSE
IMGMAPA12:MONITORCOLLISIONALPHA=FALSE

OBJECT=IMGMAPA21
IMGMAPA21:TYPE=IMAGE
IMGMAPA21:VISIBLE=FALSE
IMGMAPA21:FILENAME=IMGMAPA21.IMG
IMGMAPA21:TOCANVAS=TRUE
IMGMAPA21:PRIORITY=100
IMGMAPA21:PRELOAD=TRUE
IMGMAPA21:RELEASE=TRUE
IMGMAPA21:MONITORCOLLISION=FALSE
IMGMAPA21:MONITORCOLLISIONALPHA=FALSE

OBJECT=IMGMAPA22
IMGMAPA22:TYPE=IMAGE
IMGMAPA22:VISIBLE=FALSE
IMGMAPA22:FILENAME=IMGMAPA22.IMG
IMGMAPA22:TOCANVAS=TRUE
IMGMAPA22:PRIORITY=100
IMGMAPA22:PRELOAD=TRUE
IMGMAPA22:RELEASE=TRUE
IMGMAPA22:MONITORCOLLISION=FALSE
IMGMAPA22:MONITORCOLLISIONALPHA=FALSE

OBJECT=GGR
GGR:TYPE=GROUP

OBJECT=GRSND
GRSND:TYPE=GROUP

OBJECT=GRDYM
GRDYM:TYPE=GROUP

OBJECT=KMH_I023
KMH_I023:TYPE=SOUND
KMH_I023:FILENAME=KMH_I023.WAV
KMH_I023:PRELOAD=FALSE
KMH_I023:FLUSHAFTERPLAYED=FALSE
KMH_I023:ONFINISHED={KOLEJ^RESUME();}

OBJECT=KMH_I025
KMH_I025:TYPE=SOUND
KMH_I025:FILENAME=KMH_I025.WAV
KMH_I025:PRELOAD=FALSE
KMH_I025:FLUSHAFTERPLAYED=FALSE

OBJECT=KMH_I031
KMH_I031:TYPE=SOUND
KMH_I031:FILENAME=KMH_I031.WAV
KMH_I031:PRELOAD=FALSE
KMH_I031:FLUSHAFTERPLAYED=FALSE
KMH_I031:ONFINISHED={BEHKRAKSA^RUN();}

OBJECT=KMH_I033
KMH_I033:TYPE=SOUND
KMH_I033:FILENAME=KMH_I033.WAV
KMH_I033:PRELOAD=FALSE
KMH_I033:FLUSHAFTERPLAYED=FALSE
KMH_I033:ONFINISHED={BEHKRAKSA^RUN();}

OBJECT=KMH_I037
KMH_I037:TYPE=SOUND
KMH_I037:FILENAME=KMH_I037.WAV
KMH_I037:PRELOAD=FALSE
KMH_I037:FLUSHAFTERPLAYED=FALSE
KMH_I037:ONFINISHED={PRZYGODA^GOTO("KOLEJ");}

OBJECT=KMH_I040
KMH_I040:TYPE=SOUND
KMH_I040:FILENAME=KMH_I040.WAV
KMH_I040:PRELOAD=FALSE
KMH_I040:FLUSHAFTERPLAYED=FALSE
KMH_I040:ONFINISHED={KOLEJ^RESUME();}

OBJECT=KMH_I043
KMH_I043:TYPE=SOUND
KMH_I043:FILENAME=KMH_I043.WAV
KMH_I043:PRELOAD=FALSE
KMH_I043:FLUSHAFTERPLAYED=FALSE

OBJECT=KMH_I045
KMH_I045:TYPE=SOUND
KMH_I045:FILENAME=KMH_I045.WAV
KMH_I045:PRELOAD=FALSE
KMH_I045:FLUSHAFTERPLAYED=FALSE

OBJECT=KMH_I047
KMH_I047:TYPE=SOUND
KMH_I047:FILENAME=KMH_I047.WAV
KMH_I047:PRELOAD=FALSE
KMH_I047:FLUSHAFTERPLAYED=FALSE

OBJECT=KMH_I053
KMH_I053:TYPE=SOUND
KMH_I053:FILENAME=KMH_I053.WAV
KMH_I053:PRELOAD=FALSE
KMH_I053:FLUSHAFTERPLAYED=FALSE
KMH_I053:ONFINISHED={BSTATE^SET(FALSE);ANBLANK8^RESUME();SFX_KOLEJ_STEAM^PLAY();SFX_KOLEJ_START^PLAY();}

OBJECT=KRET_I035
KRET_I035:TYPE=SOUND
KRET_I035:FILENAME=KRET_I035.WAV
KRET_I035:PRELOAD=FALSE
KRET_I035:FLUSHAFTERPLAYED=FALSE

OBJECT=KRET_I022
KRET_I022:TYPE=SOUND
KRET_I022:FILENAME=KRET_I022.WAV
KRET_I022:PRELOAD=FALSE
KRET_I022:FLUSHAFTERPLAYED=FALSE
KRET_I022:ONFINISHED={KMH_I023^PLAY();}

OBJECT=KRET_I024
KRET_I024:TYPE=SOUND
KRET_I024:FILENAME=KRET_I024.WAV
KRET_I024:PRELOAD=FALSE
KRET_I024:FLUSHAFTERPLAYED=FALSE

OBJECT=KRET_I026
KRET_I026:TYPE=SOUND
KRET_I026:FILENAME=KRET_I026.WAV
KRET_I026:PRELOAD=FALSE
KRET_I026:FLUSHAFTERPLAYED=FALSE

OBJECT=KRET_I027
KRET_I027:TYPE=SOUND
KRET_I027:FILENAME=KRET_I027.WAV
KRET_I027:PRELOAD=FALSE
KRET_I027:FLUSHAFTERPLAYED=FALSE
KRET_I027:ONFINISHED={BEHKRAKSA^RUN();}

OBJECT=KRET_I028
KRET_I028:TYPE=SOUND
KRET_I028:FILENAME=KRET_I028.WAV
KRET_I028:PRELOAD=FALSE
KRET_I028:FLUSHAFTERPLAYED=FALSE
KRET_I028:ONFINISHED={BEHKRAKSA^RUN();}

OBJECT=KRET_I029
KRET_I029:TYPE=SOUND
KRET_I029:FILENAME=KRET_I029.WAV
KRET_I029:PRELOAD=FALSE
KRET_I029:FLUSHAFTERPLAYED=FALSE
KRET_I029:ONFINISHED={BEHKRAKSA^RUN();}

OBJECT=KRET_I032_E
KRET_I032_E:TYPE=SOUND
KRET_I032_E:FILENAME=KRET_I032_E.WAV
KRET_I032_E:PRELOAD=FALSE
KRET_I032_E:FLUSHAFTERPLAYED=FALSE
KRET_I032_E:ONFINISHED={BEHKRAKSA^RUN();}

OBJECT=KRET_I034_E
KRET_I034_E:TYPE=SOUND
KRET_I034_E:FILENAME=KRET_I034_E.WAV
KRET_I034_E:PRELOAD=FALSE
KRET_I034_E:FLUSHAFTERPLAYED=FALSE
KRET_I034_E:ONFINISHED={BEHKRAKSA^RUN();}

OBJECT=KRET_I035
KRET_I035:TYPE=SOUND
KRET_I035:FILENAME=KRET_I035.WAV
KRET_I035:PRELOAD=FALSE
KRET_I035:FLUSHAFTERPLAYED=FALSE
KRET_I035:ONFINISHED={BEHKRAKSA^RUN();}

OBJECT=KRET_I036
KRET_I036:TYPE=SOUND
KRET_I036:FILENAME=KRET_I036.WAV
KRET_I036:PRELOAD=FALSE
KRET_I036:FLUSHAFTERPLAYED=FALSE
KRET_I036:ONFINISHED={KMH_I037^PLAY();}

OBJECT=KRET_I039
KRET_I039:TYPE=SOUND
KRET_I039:FILENAME=KRET_I039.WAV
KRET_I039:PRELOAD=FALSE
KRET_I039:FLUSHAFTERPLAYED=FALSE
KRET_I039:ONFINISHED={KMH_I040^PLAY();}

OBJECT=KRET_I041
KRET_I041:TYPE=SOUND
KRET_I041:FILENAME=KRET_I041.WAV
KRET_I041:PRELOAD=FALSE
KRET_I041:FLUSHAFTERPLAYED=FALSE

OBJECT=KRET_I044
KRET_I044:TYPE=SOUND
KRET_I044:FILENAME=KRET_I044.WAV
KRET_I044:PRELOAD=FALSE
KRET_I044:FLUSHAFTERPLAYED=FALSE

OBJECT=KRET_I048
KRET_I048:TYPE=SOUND
KRET_I048:FILENAME=KRET_I048.WAV
KRET_I048:PRELOAD=FALSE
KRET_I048:FLUSHAFTERPLAYED=FALSE

OBJECT=KRET_I049
KRET_I049:TYPE=SOUND
KRET_I049:FILENAME=KRET_I049.WAV
KRET_I049:PRELOAD=FALSE
KRET_I049:FLUSHAFTERPLAYED=FALSE

OBJECT=KRET_I051
KRET_I051:TYPE=SOUND
KRET_I051:FILENAME=KRET_I051.WAV
KRET_I051:PRELOAD=FALSE
KRET_I051:FLUSHAFTERPLAYED=FALSE

OBJECT=KRET_I052
KRET_I052:TYPE=SOUND
KRET_I052:FILENAME=KRET_I052.WAV
KRET_I052:PRELOAD=FALSE
KRET_I052:FLUSHAFTERPLAYED=FALSE
KRET_I052:ONFINISHED={KMH_I053^PLAY();}

OBJECT=NAR_I038
NAR_I038:TYPE=SOUND
NAR_I038:FILENAME=NAR_I038.WAV
NAR_I038:PRELOAD=FALSE
NAR_I038:FLUSHAFTERPLAYED=FALSE
NAR_I038:ONFINISHED={KRET_I039^PLAY();}

OBJECT=NAR_I056
NAR_I056:TYPE=SOUND
NAR_I056:FILENAME=NAR_I056.WAV
NAR_I056:PRELOAD=FALSE
NAR_I056:FLUSHAFTERPLAYED=FALSE
NAR_I056:ONFINISHED={BEHENDSUCCESS^RUN();}

OBJECT=REX_I030
REX_I030:TYPE=SOUND
REX_I030:FILENAME=REX_I030.WAV
REX_I030:PRELOAD=FALSE
REX_I030:FLUSHAFTERPLAYED=FALSE
REX_I030:ONFINISHED={BEHKRAKSA^RUN();}

OBJECT=REX_I042
REX_I042:TYPE=SOUND
REX_I042:FILENAME=REX_I042.WAV
REX_I042:PRELOAD=FALSE
REX_I042:FLUSHAFTERPLAYED=FALSE

OBJECT=KMH_I055
KMH_I055:TYPE=SOUND
KMH_I055:FILENAME=KMH_I055.WAV
KMH_I055:PRELOAD=FALSE
KMH_I055:FLUSHAFTERPLAYED=FALSE
KMH_I055:ONFINISHED={NAR_I056^PLAY();ANFADE^PLAY("CLOSE");}

OBJECT=KMH_I054
KMH_I054:TYPE=SOUND
KMH_I054:FILENAME=KMH_I054.WAV
KMH_I054:PRELOAD=FALSE
KMH_I054:FLUSHAFTERPLAYED=FALSE
KMH_I054:ONFINISHED={PRZYGODA^GOTO("KOLEJ");}

OBJECT=SFX_KOLEJ_WHISTLE
SFX_KOLEJ_WHISTLE:TYPE=SOUND
SFX_KOLEJ_WHISTLE:FILENAME=SFX_KOLEJ_WHISTLE.WAV
SFX_KOLEJ_WHISTLE:PRELOAD=TRUE
SFX_KOLEJ_WHISTLE:FLUSHAFTERPLAYED=FALSE

OBJECT=SFX_KOLEJ_PUT
SFX_KOLEJ_PUT:TYPE=SOUND
SFX_KOLEJ_PUT:FILENAME=SFX_KOLEJ_PUT.WAV
SFX_KOLEJ_PUT:PRELOAD=TRUE
SFX_KOLEJ_PUT:FLUSHAFTERPLAYED=FALSE

OBJECT=SFX_KOLEJ_RUN
SFX_KOLEJ_RUN:TYPE=SOUND
SFX_KOLEJ_RUN:FILENAME=SFX_KOLEJ_RUN.WAV
SFX_KOLEJ_RUN:PRELOAD=TRUE
SFX_KOLEJ_RUN:FLUSHAFTERPLAYED=FALSE
SFX_KOLEJ_RUN:ONFINISHED={SFX_KOLEJ_RUN^PLAY();}

OBJECT=SFX_KOLEJ_START
SFX_KOLEJ_START:TYPE=SOUND
SFX_KOLEJ_START:FILENAME=SFX_KOLEJ_START.WAV
SFX_KOLEJ_START:PRELOAD=TRUE
SFX_KOLEJ_START:FLUSHAFTERPLAYED=FALSE

OBJECT=SFX_KOLEJ_STEAM
SFX_KOLEJ_STEAM:TYPE=SOUND
SFX_KOLEJ_STEAM:FILENAME=SFX_KOLEJ_STEAM.WAV
SFX_KOLEJ_STEAM:PRELOAD=TRUE
SFX_KOLEJ_STEAM:FLUSHAFTERPLAYED=FALSE

OBJECT=SFX_KOLEJ_TAKE
SFX_KOLEJ_TAKE:TYPE=SOUND
SFX_KOLEJ_TAKE:FILENAME=SFX_KOLEJ_TAKE.WAV
SFX_KOLEJ_TAKE:PRELOAD=TRUE
SFX_KOLEJ_TAKE:FLUSHAFTERPLAYED=FALSE

OBJECT=ARTYPES
ARTYPES:TYPE=ARRAY

OBJECT=ARDESCR
ARDESCR:TYPE=ARRAY

OBJECT=ARAVAIL
ARAVAIL:TYPE=ARRAY

OBJECT=ARTRACK
ARTRACK:TYPE=ARRAY

OBJECT=ARNORM
ARNORM:TYPE=ARRAY

OBJECT=ARINVRT
ARINVRT:TYPE=ARRAY

OBJECT=ARSNDARR
ARSNDARR:TYPE=ARRAY

OBJECT=ARRANDOM
ARRANDOM:TYPE=ARRAY

OBJECT=MOUSE
MOUSE:TYPE=MOUSE
MOUSE:RAW=0
MOUSE:ONCLICK^LEFT={@INT("ICI",0);@STRING("OBJ","");@BOOL("BL",FALSE);@BOOL("BW",FALSE);@IF("BEND'TRUE||BFAILED'TRUE","BFITMP27","");@IF("KRET_I022^ISPLAYING()'TRUE||KMH_I023^ISPLAYING()'TRUE","BFITMP28","");OBJ^SET(CANVASOBSERVER^GETGRAPHICSAT(MOUSE^GETPOSX(),MOUSE^GETPOSY(),TRUE,0,2,TRUE));@IF(OBJ^FIND("ANTRACK"),">","-1","BFITMP34","");}
MOUSE:ONMOVE={@INT("X2",0);@INT("Y2",0);@INT("PX",0);@INT("PY",0);@INT("GX",0);@INT("GY",0);@INT("DX2",0);@INT("DY2",0);@IF("BLOCK","_","TRUE","BFITMP35","");}
MOUSE:ONRELEASE^LEFT={@INT("GX",0);@INT("GY",0);@STRING("SEV","");@STRING("SS","");@STRING("SEL","");@STRING("SOBJ","");@BOOL("BEL",FALSE);@IF("BEND","_","TRUE","BFITMP36","");GX^SET([[MOUSE^GETPOSX()+IACCLX]@IGRIDX]);GY^SET([MOUSE^GETPOSY()@IGRIDY]);@IF("BLOCK","_","TRUE","BFITMP43","");BLOCK^SET(FALSE);}

OBJECT=CNVLOADER
CNVLOADER:TYPE=CNVLOADER

OBJECT=CANVASOBSERVER
CANVASOBSERVER:TYPE=CANVAS_OBSERVER

OBJECT=ARMAP
ARMAP:TYPE=MULTIARRAY
ARMAP:DIMENSIONS=2

OBJECT=KEYBOARD
KEYBOARD:TYPE=KEYBOARD

OBJECT=__INIT__
__INIT__:TYPE=BEHAVIOUR
__INIT__:CODE={ANNKEYBMOUSEHELP^PLAY("M");BEHMUSICSET^RUN("WIEZA");BEHAMBIENTSNDPLAY^RUN("SFX_KOLEJ_BGR");@INT("IX",0);@INT("IY",0);@INT("COL",0);@INT("DX",0);@INT("DY",0);@INT("INDEX",0);@INT("CNT",0);@STRING("STRACK","");@STRING("STMP","");IMAXETAP^SET(2);IOFFSETY^SET([2*IGRIDY]);ANFADE^PLAY("OPEN_BLACK");ANFADE^PAUSE();ANLOCO^LOAD("L0.ANN");@IF("SGAMEDIFFICULTY","_",""NORMAL"","BFITMP44","BFITMP45");IKOLEJETAP^SET(GSAVE^GET("KOLEJ_ETAP"));CANVASOBSERVER^SETBACKGROUND(["BKG"+IKOLEJETAP+".IMG"]);ANLPOS^CLONE(1);SLEVETAP^SET(["IMGMAPA"+IKOLEJLEVEL+IKOLEJETAP]);GRDYM^HIDE();ANDYM^CLONE(59);@LOOP("{GRDYM^ADD(["ANDYM_"+_I_]);}",0,59,1);ARSNDARR^ADD("KRET_I027","KRET_I028","KRET_I029","KRET_I032_E","KRET_I034_E","KRET_I035","KRET_I036","REX_I030","KMH_I031","KMH_I033");ARRANDOM^ADD("KRET_I041","REX_I042","KRET_I044","KMH_I045","KRET_I048","KRET_I049");@LOOP("{GRSND^ADD(["KRET_I0"+[_I_+22]]);GRSND^ADD(["KMH_I0"+[_I_+22]]);GRSND^ADD(["REX_I0"+[_I_+22]]);}",0,40,1);ANTRACK^HIDE();ARTYPES^ADD(0,-1,-463,-77,-14605,-22893,-31149,32377,28286,-2909,-128,-29145,15785,1322,1363,1405,-2048,10642,-3211,-29945);ARDESCR^ADD("NA","OK","RR","DD","RU","RD","DR","UR","HV","RR","DD","RU","RD","DR","UR","HV","ST","FN","X2","X3");ARAVAIL^ADD(0,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0);ARNORM^ADD("RU","RD","DR","DL","LD","LU","UL","UR","RR","DD","LL","UU");ARINVRT^ADD("DL","UL","LU","RU","UR","DR","RD","LD","LL","UU","RR","DD");IWX^SET(4);IWY^SET(9);ILX^SET(5);ILY^SET(9);IX^SET(*SLEVETAP^GETWIDTH());IY^SET(*SLEVETAP^GETHEIGHT());DX^SET(IX);DY^SET(IY);IMAXX^SET([DX+5]);IMAXY^SET([DY+1+2]);ANTRACK^CLONE([DX*DY]);IY^SET(0);CNT^SET(0);@LOOP("{IX^SET(0);@LOOP("{ARMAP^SET(IX,IY,"NA");@IF("IY'9&&IX<6","BFITMP46","");@IF("IY'9&&IX>IMAXX","BFITMP47","");IX^INC();}",0,[IMAXX+5+5],1);IY^INC();}",0,IMAXY,1);IY^SET(0);@LOOP("{IX^SET(0);@LOOP("{COL^SET(*SLEVETAP^GETPIXEL(IX,IY));INDEX^SET(ARTYPES^FIND(COL));@IF("INDEX",">","0","BFITMP52","");IX^INC();}",0,DX,1);IY^INC();}",0,DY,1);ANLOCO^CLONE(1);ANPFW^CLONE(1);ICX^SET([ILX*IGRIDX]);ICY^SET([ILY*IGRIDY]);INX^SET([IWX*IGRIDX]);INY^SET([IWY*IGRIDY]);ANLOCO^SETPOSITION(ICX,ICY);ANLPOS^MOVE(ICX,ICY);ANPFW^SETPOSITION(INX,INY);CANVASOBSERVER^MOVEBKG(0,0);SCURTRACK^SET(ARMAP^GET(ILX,ILY));SLASTTRACK^SET(ARMAP^GET(IWX,IWY));ANLOCO^SETFRAME(SCURTRACK,0);ANPFW^SETFRAME(SLASTTRACK,0);ANBLANK8^SETFRAME("TIMER16",0);ANBLANK8^SETFRAME("TIMER16",7);GRDYM^HIDE();ILASTX^SET(ANLOCO^GETCURRFRAMEPOSX());ILASTY^SET(ANLOCO^GETCURRFRAMEPOSY());ILASTWX^SET(ANPFW^GETCURRFRAMEPOSX());ILASTWY^SET(ANPFW^GETCURRFRAMEPOSY());IFAKEX^SET(1);IFAKEWX^SET(0);ANLPOS_1^MOVE([IFAKEX*IGRIDX],[9*IGRIDY]);ANLOCO_1^SETPOSITION([IFAKEX*IGRIDX],[9*IGRIDY]);ANLOCO_1^SETFRAME("RR",0);ANPFW_1^SETPOSITION([IFAKEWX*IGRIDX],[9*IGRIDY]);ANPFW_1^SETFRAME("RR",0);BLANK5^PLAY("TIMER16");SFX_KOLEJ_START^PLAY();SFX_KOLEJ_STEAM^PLAY();ANPFW^SETPRIORITY(100);ANLOCO^SETPRIORITY(50);ANLOCO^HIDE();ANPFW^HIDE();KOLEJ^PAUSE();@IF(GSAVE^GET("KOLEJ_STATUS"),"_",""NIEODWIEDZONY"","BFITMP53","BFITMP54");GRDYM^HIDE();}


OBJECT=BEHINIT2
BEHINIT2:TYPE=BEHAVIOUR
BEHINIT2:CODE={ANBLANK8^PLAY("TIMER16");ANBLANK8^SETFRAME("TIMER16",7);}


OBJECT=BEHNEXTMOVE
BEHNEXTMOVE:TYPE=BEHAVIOUR
BEHNEXTMOVE:CODE={@STRING("SRC","");@STRING("DST","");@STRING("SSND","");@INT("IDX",0);@INT("IDY",0);@INT("INDEX",0);SCURTRACK^SET(ARMAP^GET(ILX,ILY));BSTATE^SET(FALSE);@IF("SCURTRACK'"HV"||SCURTRACK'"ST"||SCURTRACK'"FN"","BFITMP61","");INDEX^SET(ARNORM^FIND(SCURTRACK));@IF("INDEX",">","-1","BFITMP65","BFITMP66");@IF("SCURTRACK!'"UU"&&SCURTRACK!'"RU"&&SCURTRACK!'"UR"&&SCURTRACK!'"UL"&&SCURTRACK!'"LU"","BFITMP67","BFITMP68");}


OBJECT=BEHKRAKSA
BEHKRAKSA:TYPE=BEHAVIOUR
BEHKRAKSA:CODE={ANFADE^PLAY("CLOSE");KRET_I036^PLAY();}


OBJECT=BEHRESTART
BEHRESTART:TYPE=BEHAVIOUR
BEHRESTART:CODE={GSAVE^SET("KOLEJ_ETAP",[IKOLEJETAP+1]);IKOLEJETAP^INC();@IF("IKOLEJETAP",">","IMAXETAP","BFITMP69","BFITMP70");}


OBJECT=BEHENDSUCCESS
BEHENDSUCCESS:TYPE=BEHAVIOUR
BEHENDSUCCESS:CODE={GSAVE^SET("KOLEJ_STATUS","UKONCZONY");GSAVE^SET("SCENE_CODE","ASZW");GSAVE^SET("SCENE_NAME","ARCADE");GSAVE^SET("ARCADE_SCENE_NAME","SZANGRILA");BEHGOTOSCENE^RUN();}


OBJECT=BFITMP0
BFITMP0:TYPE=BEHAVIOUR
BFITMP0:CODE={SFX_KOLEJ_RUN^PLAY();}


OBJECT=BFITMP1
BFITMP1:TYPE=BEHAVIOUR
BFITMP1:CODE={GRDYM^HIDE();}


OBJECT=BFITMP2
BFITMP2:TYPE=BEHAVIOUR
BFITMP2:CODE={ANPFW^SETPOSITION([INX-IX],[INY-IY2+IACCWY]);}


OBJECT=BFITMP3
BFITMP3:TYPE=BEHAVIOUR
BFITMP3:CODE={ANPFW^SETPOSITION([INX-IX+IGRIDX],[INY-IY2+IACCWY]);}


OBJECT=BFITMP4
BFITMP4:TYPE=BEHAVIOUR
BFITMP4:CODE={ANPFW^SETPOSITION([INX-IX-IGRIDX],[INY-IY2+IACCWY]);}


OBJECT=BFITMP5
BFITMP5:TYPE=BEHAVIOUR
BFITMP5:CODE={ANPFW^SETPOSITION([INX-IX-IGRIDX],[INY-IY2+IACCWY]);}


OBJECT=BFITMP6
BFITMP6:TYPE=BEHAVIOUR
BFITMP6:CODE={ANPFW^SETPOSITION([INX-IX+IGRIDX],[INY-IY2+IACCWY]);}


OBJECT=BFITMP7
BFITMP7:TYPE=BEHAVIOUR
BFITMP7:CODE={GSAVE^SET("KOLEJ_FIRST_STATION",FALSE);KRET_I052^PLAY();}


OBJECT=BFITMP8
BFITMP8:TYPE=BEHAVIOUR
BFITMP8:CODE={ANSTATION^PLAY("TIMER");}


OBJECT=BFITMP9
BFITMP9:TYPE=BEHAVIOUR
BFITMP9:CODE={ANBLANK8^PAUSE();SFX_KOLEJ_WHISTLE^PLAY();SFX_KOLEJ_STEAM^PLAY();SFX_KOLEJ_RUN^STOP(FALSE);@IF(GSAVE^GET("KOLEJ_FIRST_STATION"),"_","TRUE","BFITMP7","BFITMP8");}


OBJECT=BFITMP10
BFITMP10:TYPE=BEHAVIOUR
BFITMP10:CODE={ANBLANK8^STOP(FALSE);GRPOS_1^MOVE([IFAKEX*IGRIDX],[10*IGRIDY]);ANLOCO_1^SETPOSITION([IFAKEX*IGRIDX],[9*IGRIDY]);ANLOCO_1^SETFRAME("RR",0);ANPFW_1^SETPOSITION([IFAKEWX*IGRIDX],[9*IGRIDY]);ANPFW_1^SETFRAME("RR",0);ANLOCO^HIDE();ANPFW^HIDE();BLANK5^PLAY("TIMER16");BLANK5^SETFRAME("TIMER16",8);@BREAK();}


OBJECT=BFITMP11
BFITMP11:TYPE=BEHAVIOUR
BFITMP11:CODE={ANBLANK8^STOP(FALSE);GRPOS_1^MOVE([ILX*IGRIDX],[10*IGRIDY]);ANLOCO_1^SETPOSITION(ANLOCO^GETPOSITIONX(TRUE),ANLOCO^GETPOSITIONY(TRUE));ANLOCO_1^SETFRAME(ANLOCO^GETEVENTNAME(),8);ANLOCO_1^SHOW();ANPFW_1^SETPOSITION(ANPFW^GETPOSITIONX(TRUE),ANPFW^GETPOSITIONY(TRUE));ANPFW_1^SETFRAME(ANPFW^GETEVENTNAME(),8);ANPFW_1^SHOW();ANLOCO^HIDE();ANPFW^HIDE();BRET^SET(TRUE);IFAKEX^SET(ILX);IFAKEWX^SET(IWX);BLANK5^PLAY("TIMER16");BLANK5^SETFRAME("TIMER16",8);}


OBJECT=BFITMP12
BFITMP12:TYPE=BEHAVIOUR
BFITMP12:CODE={*SSS^PLAY("DYM");*SSS^SETPOSITION(ANLPOS^GETPOSITIONX(),ANLPOS^GETPOSITIONY());@BREAK();}


OBJECT=BFITMP13
BFITMP13:TYPE=BEHAVIOUR
BFITMP13:CODE={INX^ADD(IGRIDX);}


OBJECT=BFITMP14
BFITMP14:TYPE=BEHAVIOUR
BFITMP14:CODE={INX^SUB(IGRIDX);}


OBJECT=BFITMP15
BFITMP15:TYPE=BEHAVIOUR
BFITMP15:CODE={INX^SUB(IGRIDX);}


OBJECT=BFITMP16
BFITMP16:TYPE=BEHAVIOUR
BFITMP16:CODE={INX^ADD(IGRIDX);}


OBJECT=BFITMP17
BFITMP17:TYPE=BEHAVIOUR
BFITMP17:CODE={SFX_KOLEJ_RUN^PLAY();}


OBJECT=BFITMP18
BFITMP18:TYPE=BEHAVIOUR
BFITMP18:CODE={SFX_KOLEJ_RUN^PLAY();}


OBJECT=BFITMP19
BFITMP19:TYPE=BEHAVIOUR
BFITMP19:CODE={ANLOCO_1^HIDE();ANLOCO_1^SETPOSITION(-100,-100);ANPFW_1^HIDE();ANPFW_1^SETPOSITION(-100,-100);ANLOCO_1^HIDE();ANLPOS_1^SETPOSITION(-100,-100);ANLOCO^SHOW();ANPFW^SHOW();BLANK5^STOP(FALSE);BEHINIT2^RUN();}


OBJECT=BFITMP20
BFITMP20:TYPE=BEHAVIOUR
BFITMP20:CODE={BEHRESTART^RUN();}


OBJECT=BFITMP21
BFITMP21:TYPE=BEHAVIOUR
BFITMP21:CODE={CF^SET(BLANK5^GETCFRAMEINEVENT());ANLOCO_1^SETFRAME("LL",CF);ANPFW_1^SETFRAME(ANPFW_1^GETEVENTNAME(),CF);ANLPOS_1^SETFRAME("LL",[CF@2]);ANLOCO_1^SETPRIORITY(100);ANPFW_1^SETPRIORITY(100);}


OBJECT=BFITMP22
BFITMP22:TYPE=BEHAVIOUR
BFITMP22:CODE={ANLOCO_1^SHOW();ANPFW_1^SHOW();CF^SET(BLANK5^GETCFRAMEINEVENT());ANLOCO_1^SETFRAME("RR",CF);ANPFW_1^SETFRAME("RR",CF);ANLPOS_1^SETFRAME("RR",[CF@2]);ANLOCO_1^SETPRIORITY(100);ANPFW_1^SETPRIORITY(100);@IF(SFX_KOLEJ_RUN^ISPLAYING(),"_","FALSE","BFITMP18","");@IF("IFAKEX'5&&CF'8&&BEND'FALSE","BFITMP19","");@IF("IFAKEX'8&&CF'8","BFITMP20","");}


OBJECT=BFITMP23
BFITMP23:TYPE=BEHAVIOUR
BFITMP23:CODE={*SSS^PLAY("DYM");*SSS^SETPOSITION(ANLPOS_1^GETPOSITIONX(),ANLPOS_1^GETPOSITIONY());@BREAK();}


OBJECT=BFITMP24
BFITMP24:TYPE=BEHAVIOUR
BFITMP24:CODE={BLANK5^STOP(FALSE);BEHKRAKSA^RUN();}


OBJECT=BFITMP25
BFITMP25:TYPE=BEHAVIOUR
BFITMP25:CODE={IFAKEX^INC();IFAKEWX^INC();ANLOCO_1^SETPOSITION([IFAKEX*IGRIDX],[ILY*IGRIDY]);ANLOCO_1^SETFRAME("RR",0);ANPFW_1^SETPOSITION([IFAKEWX*IGRIDX],[IWY*IGRIDY]);ANPFW_1^SETFRAME("RR",0);ANLPOS_1^SETFRAME("RR",0);ANLPOS_1^MOVE(IGRIDX,0);BLANK5^PLAY("TIMER16");BLANK5^SETFRAME("TIMER16",1);}


OBJECT=BFITMP26
BFITMP26:TYPE=BEHAVIOUR
BFITMP26:CODE={IFAKEX^DEC();IFAKEWX^DEC();ANLOCO_1^SETPOSITION([IFAKEX*IGRIDX],[ILY*IGRIDY]);ANLOCO_1^SETFRAME("LL",0);ANPFW_1^SETPOSITION([IFAKEWX*IGRIDX],[IWY*IGRIDY]);ANPFW_1^SETFRAME("LL",0);ANLPOS_1^SETFRAME("LL",0);ANLPOS_1^MOVE(IGRIDX,0);BLANK5^PLAY("TIMER16");BLANK5^SETFRAME("TIMER16",1);@IF("IFAKEX","<","0","BFITMP24","");}


OBJECT=BFITMP27
BFITMP27:TYPE=BEHAVIOUR
BFITMP27:CODE={@BREAK();}


OBJECT=BFITMP28
BFITMP28:TYPE=BEHAVIOUR
BFITMP28:CODE={KRET_I022^STOP(FALSE);KMH_I023^STOP(FALSE);KOLEJ^RESUME();@BREAK();}


OBJECT=BFITMP29
BFITMP29:TYPE=BEHAVIOUR
BFITMP29:CODE={@BREAK();}


OBJECT=BFITMP30
BFITMP30:TYPE=BEHAVIOUR
BFITMP30:CODE={BL^SET(TRUE);}


OBJECT=BFITMP31
BFITMP31:TYPE=BEHAVIOUR
BFITMP31:CODE={BW^SET(TRUE);}


OBJECT=BFITMP32
BFITMP32:TYPE=BEHAVIOUR
BFITMP32:CODE={@BREAK();}


OBJECT=BFITMP33
BFITMP33:TYPE=BEHAVIOUR
BFITMP33:CODE={@BREAK();}


OBJECT=BFITMP34
BFITMP34:TYPE=BEHAVIOUR
BFITMP34:CODE={IDRAGX^SET([[MOUSE^GETPOSX()+IACCLX]@IGRIDX]);IDRAGY^SET([MOUSE^GETPOSY()@IGRIDY]);@IF("IDRAGX<0||IDRAGX>[IMAXX+6]||IDRAGY<3||IDRAGY>IMAXY","BFITMP29","");@IF("IDRAGX'ILX&&IDRAGY'ILY","BFITMP30","");@IF("IDRAGX'IWX&&IDRAGY'IWY","BFITMP31","");@IF("BL'TRUE||BW'TRUE","BFITMP32","");@IF("IDRAGY>IMAXY||IDRAGY<3","BFITMP33","");ICI^SET(*OBJ^GETCLONEINDEX());SLOCKED^SET(["ANTRACK_"+ICI]);ARTRACK^REMOVE(SLOCKED);ARMAP^SET(IDRAGX,IDRAGY,"OK");*SLOCKED^SETPRIORITY(2);BLOCK^SET(TRUE);SFX_KOLEJ_PUT^PLAY();}


OBJECT=BFITMP35
BFITMP35:TYPE=BEHAVIOUR
BFITMP35:CODE={GX^SET([[MOUSE^GETPOSX()+IACCLX]@IGRIDX]);GY^SET([MOUSE^GETPOSY()@IGRIDY]);PX^SET([MOUSE^GETPOSX()+IACCLX]);PY^SET([MOUSE^GETPOSY()]);DX2^SET(*SLOCKED^GETWIDTH());DY2^SET(*SLOCKED^GETHEIGHT());X2^SET([DX2@2]);Y2^SET([DY2@2]);*SLOCKED^SETPOSITION([PX-IACCLX-X2],[PY-Y2]);}


OBJECT=BFITMP36
BFITMP36:TYPE=BEHAVIOUR
BFITMP36:CODE={@BREAK();}


OBJECT=BFITMP37
BFITMP37:TYPE=BEHAVIOUR
BFITMP37:CODE={BEL^SET(TRUE);}


OBJECT=BFITMP38
BFITMP38:TYPE=BEHAVIOUR
BFITMP38:CODE={SEL^SET(ARMAP^GET(GX,GY));SOBJ^SET(CANVASOBSERVER^GETGRAPHICSAT([GX*IGRIDX-IACCLX],[GY*IGRIDY],TRUE,1,1,TRUE));@IF("SOBJ^FIND("ANTRACK")>-1||SEL'"OK"","BFITMP37","");}


OBJECT=BFITMP39
BFITMP39:TYPE=BEHAVIOUR
BFITMP39:CODE={GSAVE^SET("KOLEJ_FIRST_TRACK",FALSE);KRET_I024^PLAY();}


OBJECT=BFITMP40
BFITMP40:TYPE=BEHAVIOUR
BFITMP40:CODE={@IF(GSAVE^GET("KOLEJ_FIRST_TRACK"),"_","TRUE","BFITMP39","");}


OBJECT=BFITMP41
BFITMP41:TYPE=BEHAVIOUR
BFITMP41:CODE={ARTRACK^ADD(SLOCKED);SEV^SET(*SLOCKED^GETEVENTNAME());*SLOCKED^SETPOSITION([GX*IGRIDX-IACCLX],[GY*IGRIDY]);*SLOCKED^SETPRIORITY(1);ARMAP^SET(IDRAGX,IDRAGY,SEL);*SOBJ^SETPOSITION([IDRAGX*IGRIDX-IACCLX],[IDRAGY*IGRIDY]);ARMAP^SET(GX,GY,SEV);*SOBJ^SETPRIORITY(1);SLOCKED^SET(NULL);@IF("BFAILED","_","FALSE","BFITMP40","");}


OBJECT=BFITMP42
BFITMP42:TYPE=BEHAVIOUR
BFITMP42:CODE={ARTRACK^ADD(SLOCKED);*SLOCKED^SETPOSITION([IDRAGX*IGRIDX-IACCLX],[IDRAGY*IGRIDY]);*SLOCKED^SETPRIORITY(1);SLOCKED^SET(NULL);}


OBJECT=BFITMP43
BFITMP43:TYPE=BEHAVIOUR
BFITMP43:CODE={SFX_KOLEJ_TAKE^PLAY();@IF("GX>'0&&GX<[IMAXX+6]&&GY>2&&GY<IMAXY&&ARMAP^GET(GX,GY)!'NULL","BFITMP38","");@IF("BEL","_","TRUE","BFITMP41","BFITMP42");}


OBJECT=BFITMP44
BFITMP44:TYPE=BEHAVIOUR
BFITMP44:CODE={IKOLEJLEVEL^SET(1);}


OBJECT=BFITMP45
BFITMP45:TYPE=BEHAVIOUR
BFITMP45:CODE={IKOLEJLEVEL^SET(2);}


OBJECT=BFITMP46
BFITMP46:TYPE=BEHAVIOUR
BFITMP46:CODE={ARMAP^SET(IX,IY,"RR");ANTRSTAT^SETFRAME("RR",0);CANVASOBSERVER^PASTE("ANTRSTAT",[IX*IGRIDX],[IY*IGRIDY]);CNT^INC();}


OBJECT=BFITMP47
BFITMP47:TYPE=BEHAVIOUR
BFITMP47:CODE={ARMAP^SET(IX,IY,"RR");ANTRSTAT^SETFRAME("RR",0);CANVASOBSERVER^PASTE("ANTRSTAT",[IX*IGRIDX],[IY*IGRIDY]);CNT^INC();}


OBJECT=BFITMP48
BFITMP48:TYPE=BEHAVIOUR
BFITMP48:CODE={ARTRACK^ADD(["ANTRACK_"+CNT]);*["ANTRACK_"+CNT]^SETFRAME(STRACK,0);*["ANTRACK_"+CNT]^SETPOSITION([[IX+6]*IGRIDX],[[IY+2]*IGRIDY]);*["ANTRACK_"+CNT]^SHOW();CNT^INC();}


OBJECT=BFITMP49
BFITMP49:TYPE=BEHAVIOUR
BFITMP49:CODE={ANTRSTAT^SETFRAME(STRACK,0);CANVASOBSERVER^PASTE("ANTRSTAT",[[IX+6]*IGRIDX],[[IY+2]*IGRIDY]);}


OBJECT=BFITMP50
BFITMP50:TYPE=BEHAVIOUR
BFITMP50:CODE={@IF("INDEX","<","9","BFITMP48","BFITMP49");}


OBJECT=BFITMP51
BFITMP51:TYPE=BEHAVIOUR
BFITMP51:CODE={*["ANTRACK_"+CNT]^HIDE();}


OBJECT=BFITMP52
BFITMP52:TYPE=BEHAVIOUR
BFITMP52:CODE={STRACK^SET(ARDESCR^GET(INDEX));ARMAP^SET([IX+6],[IY+2],STRACK);@IF("STRACK!'"NA"&&STRACK!'"OK"","BFITMP50","BFITMP51");}


OBJECT=BFITMP53
BFITMP53:TYPE=BEHAVIOUR
BFITMP53:CODE={GSAVE^SET("KOLEJ_STATUS","ODWIEDZONY");ANFADE^STOP(FALSE);ANFADE^HIDE();KRET_I022^PLAY();}


OBJECT=BFITMP54
BFITMP54:TYPE=BEHAVIOUR
BFITMP54:CODE={ANFADE^RESUME();NAR_I038^PLAY();}


OBJECT=BFITMP55
BFITMP55:TYPE=BEHAVIOUR
BFITMP55:CODE={BSTATE^SET(TRUE);}


OBJECT=BFITMP56
BFITMP56:TYPE=BEHAVIOUR
BFITMP56:CODE={BEND^SET(TRUE);}


OBJECT=BFITMP57
BFITMP57:TYPE=BEHAVIOUR
BFITMP57:CODE={SCURTRACK^SET("RR");}


OBJECT=BFITMP58
BFITMP58:TYPE=BEHAVIOUR
BFITMP58:CODE={SCURTRACK^SET("LL");}


OBJECT=BFITMP59
BFITMP59:TYPE=BEHAVIOUR
BFITMP59:CODE={SCURTRACK^SET("DD");}


OBJECT=BFITMP60
BFITMP60:TYPE=BEHAVIOUR
BFITMP60:CODE={SCURTRACK^SET("UU");}


OBJECT=BFITMP61
BFITMP61:TYPE=BEHAVIOUR
BFITMP61:CODE={IDY^SET([ILY-IWY]);IDX^SET([ILX-IWX]);@IF("SCURTRACK","_",""ST"","BFITMP55","");@IF("SCURTRACK","_",""FN"","BFITMP56","");@IF("IDX",">","0","BFITMP57","");@IF("IDX","<","0","BFITMP58","");@IF("IDY",">","0","BFITMP59","");@IF("IDY","<","0","BFITMP60","");}


OBJECT=BFITMP62
BFITMP62:TYPE=BEHAVIOUR
BFITMP62:CODE={SCURTRACK^SET(DST);}


OBJECT=BFITMP63
BFITMP63:TYPE=BEHAVIOUR
BFITMP63:CODE={BFAILED^SET(TRUE);GRSND^STOP(FALSE);ANBLANK8^PAUSE();SSND^SET(ARSNDARR^GET(RANDOM^GET(ARSNDARR^GETSIZE())));*SSND^PLAY();@BREAK();}


OBJECT=BFITMP64
BFITMP64:TYPE=BEHAVIOUR
BFITMP64:CODE={@IF(SLASTTRACK^GET(1),"_",DST^GET(0),"BFITMP62","BFITMP63");}


OBJECT=BFITMP65
BFITMP65:TYPE=BEHAVIOUR
BFITMP65:CODE={SRC^SET(ARNORM^GET(INDEX));DST^SET(ARINVRT^GET(INDEX));@IF(SLASTTRACK^GET(1),"!_",SCURTRACK^GET(0),"BFITMP64","");}


OBJECT=BFITMP66
BFITMP66:TYPE=BEHAVIOUR
BFITMP66:CODE={BFAILED^SET(TRUE);GRSND^STOP(FALSE);ANBLANK8^PAUSE();SSND^SET(ARSNDARR^GET(RANDOM^GET(ARSNDARR^GETSIZE())));*SSND^PLAY();@BREAK();}


OBJECT=BFITMP67
BFITMP67:TYPE=BEHAVIOUR
BFITMP67:CODE={ANPFW^SETPRIORITY([20+ILY]);ANLOCO^SETPRIORITY([20+ILY+2]);}


OBJECT=BFITMP68
BFITMP68:TYPE=BEHAVIOUR
BFITMP68:CODE={ANPFW^SETPRIORITY([20+ILY+2]);ANLOCO^SETPRIORITY([20+ILY]);}


OBJECT=BFITMP69
BFITMP69:TYPE=BEHAVIOUR
BFITMP69:CODE={ANBLANK8^STOP(FALSE);GRSND^STOP(FALSE);KMH_I055^PLAY();}


OBJECT=BFITMP70
BFITMP70:TYPE=BEHAVIOUR
BFITMP70:CODE={ANFADE^PLAY("CLOSE");KMH_I054^PLAY();}


