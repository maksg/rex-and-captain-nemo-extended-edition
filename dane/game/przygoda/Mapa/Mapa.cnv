OBJECT=MUSIC
MUSIC:TYPE=MUSIC
MUSIC:FILENAME=INTRO.WAV

OBJECT=BDRAG
BDRAG:TYPE=BOOL

OBJECT=IFRAMENRA
IFRAMENRA:TYPE=INTEGER

OBJECT=IMOUSEX
IMOUSEX:TYPE=INTEGER
IMOUSEX:VALUE=0

OBJECT=IMOUSEY
IMOUSEY:TYPE=INTEGER
IMOUSEY:VALUE=0

OBJECT=IMOUSELASTX
IMOUSELASTX:TYPE=INTEGER
IMOUSELASTX:VALUE=0

OBJECT=IMOUSELASTY
IMOUSELASTY:TYPE=INTEGER
IMOUSELASTY:VALUE=0

OBJECT=SDRAGOBJ
SDRAGOBJ:TYPE=STRING
SDRAGOBJ:VALUE=NULL

OBJECT=BDRAGGING
BDRAGGING:TYPE=BOOL
BDRAGGING:VALUE=FALSE

OBJECT=BCANDROP
BCANDROP:TYPE=BOOL
BCANDROP:VALUE=TRUE

OBJECT=BA
BA:TYPE=BOOL

OBJECT=BB
BB:TYPE=BOOL

OBJECT=BC
BC:TYPE=BOOL

OBJECT=IFRAMENRB
IFRAMENRB:TYPE=INTEGER

OBJECT=IFRAMENRC
IFRAMENRC:TYPE=INTEGER

OBJECT=IPOSXA
IPOSXA:TYPE=INTEGER

OBJECT=IPOSYA
IPOSYA:TYPE=INTEGER

OBJECT=SOBJNAME
SOBJNAME:TYPE=STRING

OBJECT=ANNARROWA
ANNARROWA:TYPE=ANIMO
ANNARROWA:VISIBLE=TRUE
ANNARROWA:FILENAME=ARROWA.ANN
ANNARROWA:TOCANVAS=TRUE
ANNARROWA:PRIORITY=5
ANNARROWA:FPS=16
ANNARROWA:PRELOAD=TRUE
ANNARROWA:RELEASE=TRUE
ANNARROWA:MONITORCOLLISION=FALSE
ANNARROWA:MONITORCOLLISIONALPHA=FALSE

OBJECT=ANNARROWB
ANNARROWB:TYPE=ANIMO
ANNARROWB:VISIBLE=TRUE
ANNARROWB:FILENAME=ARROWB.ANN
ANNARROWB:TOCANVAS=TRUE
ANNARROWB:PRIORITY=5
ANNARROWB:FPS=16
ANNARROWB:PRELOAD=TRUE
ANNARROWB:RELEASE=TRUE
ANNARROWB:MONITORCOLLISION=FALSE
ANNARROWB:MONITORCOLLISIONALPHA=FALSE

OBJECT=ANNARROWC
ANNARROWC:TYPE=ANIMO
ANNARROWC:VISIBLE=TRUE
ANNARROWC:FILENAME=ARROWC.ANN
ANNARROWC:TOCANVAS=TRUE
ANNARROWC:PRIORITY=5
ANNARROWC:FPS=16
ANNARROWC:PRELOAD=TRUE
ANNARROWC:RELEASE=TRUE
ANNARROWC:MONITORCOLLISION=FALSE
ANNARROWC:MONITORCOLLISIONALPHA=FALSE

OBJECT=ANNCROSS
ANNCROSS:TYPE=ANIMO
ANNCROSS:VISIBLE=FALSE
ANNCROSS:FILENAME=CROSS.ANN
ANNCROSS:TOCANVAS=TRUE
ANNCROSS:PRIORITY=3
ANNCROSS:FPS=16
ANNCROSS:PRELOAD=TRUE
ANNCROSS:RELEASE=TRUE
ANNCROSS:MONITORCOLLISION=FALSE
ANNCROSS:MONITORCOLLISIONALPHA=FALSE

OBJECT=ANNARROWMASKA
ANNARROWMASKA:TYPE=ANIMO
ANNARROWMASKA:VISIBLE=FALSE
ANNARROWMASKA:FILENAME=ARROWMASKA.ANN
ANNARROWMASKA:TOCANVAS=TRUE
ANNARROWMASKA:PRIORITY=0
ANNARROWMASKA:FPS=16
ANNARROWMASKA:PRELOAD=TRUE
ANNARROWMASKA:RELEASE=TRUE
ANNARROWMASKA:MONITORCOLLISION=FALSE
ANNARROWMASKA:MONITORCOLLISIONALPHA=FALSE

OBJECT=ANNARROWMASKB
ANNARROWMASKB:TYPE=ANIMO
ANNARROWMASKB:VISIBLE=FALSE
ANNARROWMASKB:FILENAME=ARROWMASKB.ANN
ANNARROWMASKB:TOCANVAS=TRUE
ANNARROWMASKB:PRIORITY=0
ANNARROWMASKB:FPS=16
ANNARROWMASKB:PRELOAD=TRUE
ANNARROWMASKB:RELEASE=TRUE
ANNARROWMASKB:MONITORCOLLISION=FALSE
ANNARROWMASKB:MONITORCOLLISIONALPHA=FALSE

OBJECT=ANNARROWMASKC
ANNARROWMASKC:TYPE=ANIMO
ANNARROWMASKC:VISIBLE=FALSE
ANNARROWMASKC:FILENAME=ARROWMASKC.ANN
ANNARROWMASKC:TOCANVAS=TRUE
ANNARROWMASKC:PRIORITY=0
ANNARROWMASKC:FPS=16
ANNARROWMASKC:PRELOAD=TRUE
ANNARROWMASKC:RELEASE=TRUE
ANNARROWMASKC:MONITORCOLLISION=FALSE
ANNARROWMASKC:MONITORCOLLISIONALPHA=FALSE

OBJECT=ANNPIXA
ANNPIXA:TYPE=ANIMO
ANNPIXA:VISIBLE=FALSE
ANNPIXA:FILENAME=PIXA.ANN
ANNPIXA:TOCANVAS=TRUE
ANNPIXA:PRIORITY=0
ANNPIXA:FPS=16
ANNPIXA:PRELOAD=TRUE
ANNPIXA:RELEASE=TRUE
ANNPIXA:MONITORCOLLISION=FALSE
ANNPIXA:MONITORCOLLISIONALPHA=FALSE

OBJECT=ANNPIXB
ANNPIXB:TYPE=ANIMO
ANNPIXB:VISIBLE=FALSE
ANNPIXB:FILENAME=PIXB.ANN
ANNPIXB:TOCANVAS=TRUE
ANNPIXB:PRIORITY=0
ANNPIXB:FPS=16
ANNPIXB:PRELOAD=TRUE
ANNPIXB:RELEASE=TRUE
ANNPIXB:MONITORCOLLISION=FALSE
ANNPIXB:MONITORCOLLISIONALPHA=FALSE

OBJECT=ANNPIXC
ANNPIXC:TYPE=ANIMO
ANNPIXC:VISIBLE=FALSE
ANNPIXC:FILENAME=PIXC.ANN
ANNPIXC:TOCANVAS=TRUE
ANNPIXC:PRIORITY=0
ANNPIXC:FPS=16
ANNPIXC:PRELOAD=TRUE
ANNPIXC:RELEASE=TRUE
ANNPIXC:MONITORCOLLISION=FALSE
ANNPIXC:MONITORCOLLISIONALPHA=FALSE

OBJECT=SEQWSTNORMAL
SEQWSTNORMAL:TYPE=SEQUENCE
SEQWSTNORMAL:FILENAME=SEWSTNORMAL.SEQ

OBJECT=SEQSUKCES
SEQSUKCES:TYPE=SEQUENCE
SEQSUKCES:FILENAME=SESUKCES.SEQ
SEQSUKCES:ONSTARTED={GRSEQ^STOP();SFX_MAPA_OK^PLAY();}
SEQSUKCES:ONFINISHED={SEQCROSSEND^PLAY("SECROSSEND");}

OBJECT=SEQCROSSEND
SEQCROSSEND:TYPE=SEQUENCE
SEQCROSSEND:FILENAME=SECROSSEND.SEQ
SEQCROSSEND:ONFINISHED={BEHSUCCESS^RUN();}
SEQCROSSEND:ONSTARTED={ANNCROSS^SHOW();SFX_MAPA_KOLKO^PLAY();}

OBJECT=TCANDROP
TCANDROP:TYPE=TIMER
TCANDROP:ENABLED=FALSE
TCANDROP:ELAPSE=220
TCANDROP:TICKS=1
TCANDROP:ONTICK={BCANDROP^SET(TRUE);}

OBJECT=GRSEQ
GRSEQ:TYPE=GROUP

OBJECT=NAR_U090
NAR_U090:TYPE=SOUND
NAR_U090:FILENAME=NAR_U090.WAV
NAR_U090:PRELOAD=FALSE
NAR_U090:FLUSHAFTERPLAYED=FALSE

OBJECT=REX_U091
REX_U091:TYPE=SOUND
REX_U091:FILENAME=REX_U091.WAV
REX_U091:PRELOAD=FALSE
REX_U091:FLUSHAFTERPLAYED=FALSE

OBJECT=REX_U094
REX_U094:TYPE=SOUND
REX_U094:FILENAME=REX_U094.WAV
REX_U094:PRELOAD=FALSE
REX_U094:FLUSHAFTERPLAYED=FALSE

OBJECT=KRET_U092
KRET_U092:TYPE=SOUND
KRET_U092:FILENAME=KRET_U092.WAV
KRET_U092:PRELOAD=FALSE
KRET_U092:FLUSHAFTERPLAYED=FALSE

OBJECT=KRET_U093
KRET_U093:TYPE=SOUND
KRET_U093:FILENAME=KRET_U093.WAV
KRET_U093:PRELOAD=FALSE
KRET_U093:FLUSHAFTERPLAYED=FALSE

OBJECT=KRET_U095
KRET_U095:TYPE=SOUND
KRET_U095:FILENAME=KRET_U095.WAV
KRET_U095:PRELOAD=FALSE
KRET_U095:FLUSHAFTERPLAYED=FALSE

OBJECT=KRET_U096
KRET_U096:TYPE=SOUND
KRET_U096:FILENAME=KRET_U096.WAV
KRET_U096:PRELOAD=FALSE
KRET_U096:FLUSHAFTERPLAYED=FALSE

OBJECT=KRET_AW08
KRET_AW08:TYPE=SOUND
KRET_AW08:FILENAME=KRET_AW08.WAV
KRET_AW08:PRELOAD=FALSE
KRET_AW08:FLUSHAFTERPLAYED=FALSE

OBJECT=SFX_MAP_ROTATE
SFX_MAP_ROTATE:TYPE=SOUND
SFX_MAP_ROTATE:FILENAME=SFX_MAP_ROTATE.WAV
SFX_MAP_ROTATE:PRELOAD=TRUE
SFX_MAP_ROTATE:FLUSHAFTERPLAYED=FALSE

OBJECT=SFX_MAP_TAKE
SFX_MAP_TAKE:TYPE=SOUND
SFX_MAP_TAKE:FILENAME=SFX_MAP_TAKE.WAV
SFX_MAP_TAKE:PRELOAD=TRUE
SFX_MAP_TAKE:FLUSHAFTERPLAYED=FALSE

OBJECT=SFX_MAPA_OK
SFX_MAPA_OK:TYPE=SOUND
SFX_MAPA_OK:FILENAME=SFX_MAPA_OK.WAV
SFX_MAPA_OK:PRELOAD=TRUE
SFX_MAPA_OK:FLUSHAFTERPLAYED=FALSE

OBJECT=SFX_MAPA_KOLKO
SFX_MAPA_KOLKO:TYPE=SOUND
SFX_MAPA_KOLKO:FILENAME=SFX_MAPA_KOLKO.WAV
SFX_MAPA_KOLKO:PRELOAD=TRUE
SFX_MAPA_KOLKO:FLUSHAFTERPLAYED=FALSE

OBJECT=MOUSE
MOUSE:TYPE=MOUSE
MOUSE:RAW=0
MOUSE:ONCLICK^RIGHT={@IF("SDRAGOBJ","_",""ANNARROWA"","BFITMP1","");@IF("SDRAGOBJ","_",""ANNARROWB"","BFITMP3","");@IF("SDRAGOBJ","_",""ANNARROWC"","BFITMP5","");}
MOUSE:ONCLICK^LEFT={BEHGET^RUN();}
MOUSE:ONRELEASE^LEFT={BEHDROP^RUN();}
MOUSE:ONMOVE={IMOUSEX^SET(MOUSE^GETPOSX());IMOUSEY^SET(MOUSE^GETPOSY());@IF("SDRAGOBJ","!_","NULL","BFITMP6","");IMOUSELASTX^SET(IMOUSEX);IMOUSELASTY^SET(IMOUSEY);}

OBJECT=CNVLOADER
CNVLOADER:TYPE=CNVLOADER

OBJECT=CANVASOBSERVER
CANVASOBSERVER:TYPE=CANVAS_OBSERVER

OBJECT=KEYBOARD
KEYBOARD:TYPE=KEYBOARD

OBJECT=__INIT__
__INIT__:TYPE=BEHAVIOUR
__INIT__:CODE={ANNKEYBMOUSEHELP^PLAY("M");BEHMUSICSET^RUN("INTRO");BEHAMBIENTSNDPLAY^RUN("SFX_NAUTILUS_INSIDE");@IF("SGAMEDIFFICULTY","_",""NORMAL"","BFITMP7","BFITMP8");SEQWSTNORMAL^PLAY("SEWSTNORMAL");GRSEQ^ADD("SEQWSTNORMAL");}


OBJECT=BEHGET
BEHGET:TYPE=BEHAVIOUR
BEHGET:CODE={@IF("BDRAGGING","_","FALSE","BFITMP13","");}


OBJECT=BEHDROP
BEHDROP:TYPE=BEHAVIOUR
BEHDROP:CODE={@INT("X",0);@INT("Y",0);@IF("BDRAGGING'TRUE&&BCANDROP'TRUE","BFITMP29","");}


OBJECT=BEHSUCCESS
BEHSUCCESS:TYPE=BEHAVIOUR
BEHSUCCESS:CODE={GSAVE^SET("NOTES_MAPA_STATUS","UKONCZONY");GSAVE^SET("SCENE_CODE","CWEG");GSAVE^SET("SCENE_NAME","CUTSCENKI");GSAVE^SET("CS_SCENE_NAME","37_PRE_WEGORZE");BEHGOTOSCENE^RUN();}


OBJECT=BFITMP0
BFITMP0:TYPE=BEHAVIOUR
BFITMP0:CODE={IFRAMENRA^SET(0);}


OBJECT=BFITMP1
BFITMP1:TYPE=BEHAVIOUR
BFITMP1:CODE={IFRAMENRA^INC();@IF("IFRAMENRA","_","8","BFITMP0","");*SDRAGOBJ^SETFRAME(["ARROW"+IFRAMENRA],0);SFX_MAP_ROTATE^PLAY();}


OBJECT=BFITMP2
BFITMP2:TYPE=BEHAVIOUR
BFITMP2:CODE={IFRAMENRB^SET(0);}


OBJECT=BFITMP3
BFITMP3:TYPE=BEHAVIOUR
BFITMP3:CODE={IFRAMENRB^INC();@IF("IFRAMENRB","_","8","BFITMP2","");*SDRAGOBJ^SETFRAME(["ARROW"+IFRAMENRB],0);SFX_MAP_ROTATE^PLAY();}


OBJECT=BFITMP4
BFITMP4:TYPE=BEHAVIOUR
BFITMP4:CODE={IFRAMENRC^SET(0);}


OBJECT=BFITMP5
BFITMP5:TYPE=BEHAVIOUR
BFITMP5:CODE={IFRAMENRC^INC();@IF("IFRAMENRC","_","8","BFITMP4","");*SDRAGOBJ^SETFRAME(["ARROW"+IFRAMENRC],0);SFX_MAP_ROTATE^PLAY();}


OBJECT=BFITMP6
BFITMP6:TYPE=BEHAVIOUR
BFITMP6:CODE={*SDRAGOBJ^MOVE([IMOUSEX-IMOUSELASTX],[IMOUSEY-IMOUSELASTY]);}


OBJECT=BFITMP7
BFITMP7:TYPE=BEHAVIOUR
BFITMP7:CODE={SEQWSTNORMAL^PLAY("SEWSTNORMAL");ANNARROWA^SETFRAME("ARROW4",0);ANNARROWB^SETFRAME("ARROW4",0);ANNARROWC^SETFRAME("ARROW4",0);IFRAMENRA^SET(4);IFRAMENRB^SET(4);IFRAMENRC^SET(4);}


OBJECT=BFITMP8
BFITMP8:TYPE=BEHAVIOUR
BFITMP8:CODE={ANNARROWA^SETFRAME("ARROW4",0);IFRAMENRA^SET(4);}


OBJECT=BFITMP9
BFITMP9:TYPE=BEHAVIOUR
BFITMP9:CODE={SOBJNAME^SET(SDRAGOBJ);ANNARROWA^SETPOSITION([MOUSE^GETPOSX()-635],[MOUSE^GETPOSY()-129]);SFX_MAP_TAKE^PLAY();}


OBJECT=BFITMP10
BFITMP10:TYPE=BEHAVIOUR
BFITMP10:CODE={SOBJNAME^SET(SDRAGOBJ);ANNARROWB^SETPOSITION([MOUSE^GETPOSX()-698],[MOUSE^GETPOSY()-309]);SFX_MAP_TAKE^PLAY();}


OBJECT=BFITMP11
BFITMP11:TYPE=BEHAVIOUR
BFITMP11:CODE={SOBJNAME^SET(SDRAGOBJ);ANNARROWC^SETPOSITION([MOUSE^GETPOSX()-593],[MOUSE^GETPOSY()-237]);SFX_MAP_TAKE^PLAY();}


OBJECT=BFITMP12
BFITMP12:TYPE=BEHAVIOUR
BFITMP12:CODE={BDRAGGING^SET(TRUE);BCANDROP^SET(FALSE);TCANDROP^ENABLE();@IF("SDRAGOBJ","_",""ANNARROWA"","BFITMP9","");@IF("SDRAGOBJ","_",""ANNARROWB"","BFITMP10","");@IF("SDRAGOBJ","_",""ANNARROWC"","BFITMP11","");}


OBJECT=BFITMP13
BFITMP13:TYPE=BEHAVIOUR
BFITMP13:CODE={SDRAGOBJ^SET(CANVASOBSERVER^GETGRAPHICSAT(MOUSE^GETPOSX(),MOUSE^GETPOSY(),TRUE,5,5,FALSE));@IF("SDRAGOBJ","!_","NULL","BFITMP12","");}


OBJECT=BFITMP14
BFITMP14:TYPE=BEHAVIOUR
BFITMP14:CODE={SEQSUKCES^PLAY("SESUKCES");}


OBJECT=BFITMP15
BFITMP15:TYPE=BEHAVIOUR
BFITMP15:CODE={KRET_AW08^PLAY();}


OBJECT=BFITMP16
BFITMP16:TYPE=BEHAVIOUR
BFITMP16:CODE={ANNARROWA^SETPOSITION(-448,161);ANNARROWA^SETPRIORITY(3);BA^SET(TRUE);@IF("BA'TRUE&&BB'TRUE&&BC'TRUE","BFITMP14","BFITMP15");}


OBJECT=BFITMP17
BFITMP17:TYPE=BEHAVIOUR
BFITMP17:CODE={@IF("IFRAMENRA","_","0","BFITMP16","");}


OBJECT=BFITMP18
BFITMP18:TYPE=BEHAVIOUR
BFITMP18:CODE={@IF(SDRAGOBJ^FIND("ANNPIXA"),">","-1","BFITMP17","");}


OBJECT=BFITMP19
BFITMP19:TYPE=BEHAVIOUR
BFITMP19:CODE={SEQSUKCES^PLAY("SESUKCES");}


OBJECT=BFITMP20
BFITMP20:TYPE=BEHAVIOUR
BFITMP20:CODE={KRET_AW08^PLAY();}


OBJECT=BFITMP21
BFITMP21:TYPE=BEHAVIOUR
BFITMP21:CODE={ANNARROWB^SETPOSITION(-346,13);ANNARROWB^SETPRIORITY(3);BB^SET(TRUE);@IF("BA'TRUE&&BB'TRUE&&BC'TRUE","BFITMP19","BFITMP20");}


OBJECT=BFITMP22
BFITMP22:TYPE=BEHAVIOUR
BFITMP22:CODE={@IF("IFRAMENRB","_","0","BFITMP21","");}


OBJECT=BFITMP23
BFITMP23:TYPE=BEHAVIOUR
BFITMP23:CODE={@IF(SDRAGOBJ^FIND("ANNPIXB"),">","-1","BFITMP22","");}


OBJECT=BFITMP24
BFITMP24:TYPE=BEHAVIOUR
BFITMP24:CODE={SEQSUKCES^PLAY("SESUKCES");}


OBJECT=BFITMP25
BFITMP25:TYPE=BEHAVIOUR
BFITMP25:CODE={KRET_AW08^PLAY();}


OBJECT=BFITMP26
BFITMP26:TYPE=BEHAVIOUR
BFITMP26:CODE={ANNARROWC^SETPOSITION(-356,-30);ANNARROWC^SETPRIORITY(3);BC^SET(TRUE);@IF("BA'TRUE&&BB'TRUE&&BC'TRUE","BFITMP24","BFITMP25");}


OBJECT=BFITMP27
BFITMP27:TYPE=BEHAVIOUR
BFITMP27:CODE={@IF("IFRAMENRC","_","0","BFITMP26","");}


OBJECT=BFITMP28
BFITMP28:TYPE=BEHAVIOUR
BFITMP28:CODE={@IF(SDRAGOBJ^FIND("ANNPIXC"),">","-1","BFITMP27","");}


OBJECT=BFITMP29
BFITMP29:TYPE=BEHAVIOUR
BFITMP29:CODE={SDRAGOBJ^SET(CANVASOBSERVER^GETGRAPHICSAT(IMOUSEX,IMOUSEY,FALSE,0,0,FALSE));@IF("SOBJNAME","_",""ANNARROWA"","BFITMP18","");@IF("SOBJNAME","_",""ANNARROWB"","BFITMP23","");@IF("SOBJNAME","_",""ANNARROWC"","BFITMP28","");SDRAGOBJ^SET(NULL);BDRAGGING^SET(FALSE);}


